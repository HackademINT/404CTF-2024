from sage.all import *
from sage.crypto.sbox import SBox

def matrix_overview(BB):
  print()
  for ii in range(BB.dimensions()[0]):
    a = ('%02d ' % ii)
    for jj in range(BB.dimensions()[1]):
      if BB[ii,jj] == 0:
        a += '0' 
      elif BB[ii,jj] == 1:
        a += '1'
      else:
        a += 'X'
      if BB.dimensions()[0] < 60:
        a += ' '
    print(a)

def int2block(n):
	K4 = GF(2**128)
	return vector(K4._cache.fetch_int(n))[::-1]
def block2int(b):
	return [sum([int(b[i+j])*2**(7-j) for j in range(8)]) for i in range(0,128,8)]

def test_matrix(M):
	K3 = GF(2**64)
	V = vector(K3._cache.fetch_int(0x0102030405060708))[::-1]
	r = M*V
	return [sum([int(r[i+j])*2**(7-j) for j in range(8)]) for i in range(0,64,8)]

def test_matrix2(M, V=None):

	K3 = GF(2**128)
	if V is None:
		V = vector(K3._cache.fetch_int(0x0102030405060708090A0B0C0D0E0F10))[::-1]
	else:
		V = vector(K3._cache.fetch_int(V))[::-1]
	r = M*V
	return [sum([int(r[i+j])*2**(7-j) for j in range(8)]) for i in range(0,128,8)]

def test_mult(M):
	K3 = GF(2**64)
	V = vector(K3._cache.fetch_int(0x0102030405060708))
	r = M*V[::-1]
	return [sum([int(r[i+j])*2^(7-j) for j in range(8)]) for i in range(0,64,8)]

def verif_mult(L1,L2):
	for i in range(13):
		for j in range(256):
			c = (L1[i]*vector(kint(j))[::-1])
			s = sum([int(c[k])*(2**(7-k)) for k in range(8)])
			if int(s) != L2[i][j]:
				print("Error à index",i,j)
				return False
	return True



##################
# Cipher
##################
N_TOUR=10

# K.<x> = GF(2^8,modulus=x^8+x^4+x^3+x+1)
K2 = GF(2)

# kint = K._cache.fetch_int
P = [13,  0, 10,  5,  9,  2,  4,  8,  1,  7, 12, 15, 14, 11,  6,  3]
SBOX = (0, 78, 175, 225, 64, 14, 239, 161, 9, 71, 166, 232, 73, 7, 230, 168, 92, 18, 243, 189, 28, 82, 179, 253, 85, 27, 250, 180, 21, 91, 186, 244, 42, 100, 133, 203, 106, 36, 197, 139, 35, 109, 140, 194, 99, 45, 204, 130, 118, 56, 217, 151, 54, 120, 153, 215, 127, 49, 208, 158, 63, 113, 144, 222, 160, 238, 15, 65, 224, 174, 79, 1, 169, 231, 6, 72, 233, 167, 70, 8, 252, 178, 83, 29, 188, 242, 19, 93, 245, 187, 90, 20, 181, 251, 26, 84, 138, 196, 37, 107, 202, 132, 101, 43, 131, 205, 44, 98, 195, 141, 108, 34, 214, 152, 121, 55, 150, 216, 57, 119, 223, 145, 112, 62, 159, 209, 48, 126, 67, 13, 236, 162, 3, 77, 172, 226, 74, 4, 229, 171, 10, 68, 165, 235, 31, 81, 176, 254, 95, 17, 240, 190, 22, 88, 185, 247, 86, 24, 249, 183, 105, 39, 198, 136, 41, 103, 134, 200, 96, 46, 207, 129, 32, 110, 143, 193, 53, 123, 154, 212, 117, 59, 218, 148, 60, 114, 147, 221, 124, 50, 211, 157, 227, 173, 76, 2, 163, 237, 12, 66, 234, 164, 69, 11, 170, 228, 5, 75, 191, 241, 16, 94, 255, 177, 80, 30, 182, 248, 25, 87, 246, 184, 89, 23, 201, 135, 102, 40, 137, 199, 38, 104, 192, 142, 111, 33, 128, 206, 47, 97, 149, 219, 58, 116, 213, 155, 122, 52, 156, 210, 51, 125, 220, 146, 115, 61)
KEXP = (0, 27, 14, 21, 78, 85, 64, 91, 72, 83, 70, 93, 6, 29, 8, 19, 46, 53, 32, 59, 96, 123, 110, 117, 102, 125, 104, 115, 40, 51, 38, 61, 248, 227, 246, 237, 182, 173, 184, 163, 176, 171, 190, 165, 254, 229, 240, 235, 214, 205, 216, 195, 152, 131, 150, 141, 158, 133, 144, 139, 208, 203, 222, 197, 132, 159, 138, 145, 202, 209, 196, 223, 204, 215, 194, 217, 130, 153, 140, 151, 170, 177, 164, 191, 228, 255, 234, 241, 226, 249, 236, 247, 172, 183, 162, 185, 124, 103, 114, 105, 50, 41, 60, 39, 52, 47, 58, 33, 122, 97, 116, 111, 82, 73, 92, 71, 28, 7, 18, 9, 26, 1, 20, 15, 84, 79, 90, 65, 175, 180, 161, 186, 225, 250, 239, 244, 231, 252, 233, 242, 169, 178, 167, 188, 129, 154, 143, 148, 207, 212, 193, 218, 201, 210, 199, 220, 135, 156, 137, 146, 87, 76, 89, 66, 25, 2, 23, 12, 31, 4, 17, 10, 81, 74, 95, 68, 121, 98, 119, 108, 55, 44, 57, 34, 49, 42, 63, 36, 127, 100, 113, 106, 43, 48, 37, 62, 101, 126, 107, 112, 99, 120, 109, 118, 45, 54, 35, 56, 5, 30, 11, 16, 75, 80, 69, 94, 77, 86, 67, 88, 3, 24, 13, 22, 211, 200, 221, 198, 157, 134, 147, 136, 155, 128, 149, 142, 213, 206, 219, 192, 253, 230, 243, 232, 179, 168, 189, 166, 181, 174, 187, 160, 251, 224, 245, 238)
I = Matrix.identity(16)
M_shuffle_partial = Matrix.identity(16)[::-1]*Matrix([I[P[i]] for i in range(16)])
T = Matrix.identity(16)[::-1]
T = block_matrix([[int(T[j][i])*Matrix.identity(8) for i in range(16)] for j in range(16)])

M_shuffle = T*block_matrix(K2,[[M_shuffle_partial[j][i]*Matrix.identity(8) for j in range(16)] for i in range(16)])


M2 = SBox([0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46, 48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236, 238, 240, 242, 244, 246, 248, 250, 252, 254, 29, 31, 25, 27, 21, 23, 17, 19, 13, 15, 9, 11, 5, 7, 1, 3, 61, 63, 57, 59, 53, 55, 49, 51, 45, 47, 41, 43, 37, 39, 33, 35, 93, 95, 89, 91, 85, 87, 81, 83, 77, 79, 73, 75, 69, 71, 65, 67, 125, 127, 121, 123, 117, 119, 113, 115, 109, 111, 105, 107, 101, 103, 97, 99, 157, 159, 153, 155, 149, 151, 145, 147, 141, 143, 137, 139, 133, 135, 129, 131, 189, 191, 185, 187, 181, 183, 177, 179, 173, 175, 169, 171, 165, 167, 161, 163, 221, 223, 217, 219, 213, 215, 209, 211, 205, 207, 201, 203, 197, 199, 193, 195, 253, 255, 249, 251, 245, 247, 241, 243, 237, 239, 233, 235, 229, 231, 225, 227])
M142 = SBox([0, 142, 1, 143, 2, 140, 3, 141, 4, 138, 5, 139, 6, 136, 7, 137, 8, 134, 9, 135, 10, 132, 11, 133, 12, 130, 13, 131, 14, 128, 15, 129, 16, 158, 17, 159, 18, 156, 19, 157, 20, 154, 21, 155, 22, 152, 23, 153, 24, 150, 25, 151, 26, 148, 27, 149, 28, 146, 29, 147, 30, 144, 31, 145, 32, 174, 33, 175, 34, 172, 35, 173, 36, 170, 37, 171, 38, 168, 39, 169, 40, 166, 41, 167, 42, 164, 43, 165, 44, 162, 45, 163, 46, 160, 47, 161, 48, 190, 49, 191, 50, 188, 51, 189, 52, 186, 53, 187, 54, 184, 55, 185, 56, 182, 57, 183, 58, 180, 59, 181, 60, 178, 61, 179, 62, 176, 63, 177, 64, 206, 65, 207, 66, 204, 67, 205, 68, 202, 69, 203, 70, 200, 71, 201, 72, 198, 73, 199, 74, 196, 75, 197, 76, 194, 77, 195, 78, 192, 79, 193, 80, 222, 81, 223, 82, 220, 83, 221, 84, 218, 85, 219, 86, 216, 87, 217, 88, 214, 89, 215, 90, 212, 91, 213, 92, 210, 93, 211, 94, 208, 95, 209, 96, 238, 97, 239, 98, 236, 99, 237, 100, 234, 101, 235, 102, 232, 103, 233, 104, 230, 105, 231, 106, 228, 107, 229, 108, 226, 109, 227, 110, 224, 111, 225, 112, 254, 113, 255, 114, 252, 115, 253, 116, 250, 117, 251, 118, 248, 119, 249, 120, 246, 121, 247, 122, 244, 123, 245, 124, 242, 125, 243, 126, 240, 127, 241])
M71 = SBox([0, 71, 142, 201, 1, 70, 143, 200, 2, 69, 140, 203, 3, 68, 141, 202, 4, 67, 138, 205, 5, 66, 139, 204, 6, 65, 136, 207, 7, 64, 137, 206, 8, 79, 134, 193, 9, 78, 135, 192, 10, 77, 132, 195, 11, 76, 133, 194, 12, 75, 130, 197, 13, 74, 131, 196, 14, 73, 128, 199, 15, 72, 129, 198, 16, 87, 158, 217, 17, 86, 159, 216, 18, 85, 156, 219, 19, 84, 157, 218, 20, 83, 154, 221, 21, 82, 155, 220, 22, 81, 152, 223, 23, 80, 153, 222, 24, 95, 150, 209, 25, 94, 151, 208, 26, 93, 148, 211, 27, 92, 149, 210, 28, 91, 146, 213, 29, 90, 147, 212, 30, 89, 144, 215, 31, 88, 145, 214, 32, 103, 174, 233, 33, 102, 175, 232, 34, 101, 172, 235, 35, 100, 173, 234, 36, 99, 170, 237, 37, 98, 171, 236, 38, 97, 168, 239, 39, 96, 169, 238, 40, 111, 166, 225, 41, 110, 167, 224, 42, 109, 164, 227, 43, 108, 165, 226, 44, 107, 162, 229, 45, 106, 163, 228, 46, 105, 160, 231, 47, 104, 161, 230, 48, 119, 190, 249, 49, 118, 191, 248, 50, 117, 188, 251, 51, 116, 189, 250, 52, 115, 186, 253, 53, 114, 187, 252, 54, 113, 184, 255, 55, 112, 185, 254, 56, 127, 182, 241, 57, 126, 183, 240, 58, 125, 180, 243, 59, 124, 181, 242, 60, 123, 178, 245, 61, 122, 179, 244, 62, 121, 176, 247, 63, 120, 177, 246])
M16 = SBox([0, 16, 32, 48, 64, 80, 96, 112, 128, 144, 160, 176, 192, 208, 224, 240, 29, 13, 61, 45, 93, 77, 125, 109, 157, 141, 189, 173, 221, 205, 253, 237, 58, 42, 26, 10, 122, 106, 90, 74, 186, 170, 154, 138, 250, 234, 218, 202, 39, 55, 7, 23, 103, 119, 71, 87, 167, 183, 135, 151, 231, 247, 199, 215, 116, 100, 84, 68, 52, 36, 20, 4, 244, 228, 212, 196, 180, 164, 148, 132, 105, 121, 73, 89, 41, 57, 9, 25, 233, 249, 201, 217, 169, 185, 137, 153, 78, 94, 110, 126, 14, 30, 46, 62, 206, 222, 238, 254, 142, 158, 174, 190, 83, 67, 115, 99, 19, 3, 51, 35, 211, 195, 243, 227, 147, 131, 179, 163, 232, 248, 200, 216, 168, 184, 136, 152, 104, 120, 72, 88, 40, 56, 8, 24, 245, 229, 213, 197, 181, 165, 149, 133, 117, 101, 85, 69, 53, 37, 21, 5, 210, 194, 242, 226, 146, 130, 178, 162, 82, 66, 114, 98, 18, 2, 50, 34, 207, 223, 239, 255, 143, 159, 175, 191, 79, 95, 111, 127, 15, 31, 47, 63, 156, 140, 188, 172, 220, 204, 252, 236, 28, 12, 60, 44, 92, 76, 124, 108, 129, 145, 161, 177, 193, 209, 225, 241, 1, 17, 33, 49, 65, 81, 97, 113, 166, 182, 134, 150, 230, 246, 198, 214, 38, 54, 6, 22, 102, 118, 70, 86, 187, 171, 155, 139, 251, 235, 219, 203, 59, 43, 27, 11, 123, 107, 91, 75])
M70 = SBox([0, 70, 140, 202, 5, 67, 137, 207, 10, 76, 134, 192, 15, 73, 131, 197, 20, 82, 152, 222, 17, 87, 157, 219, 30, 88, 146, 212, 27, 93, 151, 209, 40, 110, 164, 226, 45, 107, 161, 231, 34, 100, 174, 232, 39, 97, 171, 237, 60, 122, 176, 246, 57, 127, 181, 243, 54, 112, 186, 252, 51, 117, 191, 249, 80, 22, 220, 154, 85, 19, 217, 159, 90, 28, 214, 144, 95, 25, 211, 149, 68, 2, 200, 142, 65, 7, 205, 139, 78, 8, 194, 132, 75, 13, 199, 129, 120, 62, 244, 178, 125, 59, 241, 183, 114, 52, 254, 184, 119, 49, 251, 189, 108, 42, 224, 166, 105, 47, 229, 163, 102, 32, 234, 172, 99, 37, 239, 169, 160, 230, 44, 106, 165, 227, 41, 111, 170, 236, 38, 96, 175, 233, 35, 101, 180, 242, 56, 126, 177, 247, 61, 123, 190, 248, 50, 116, 187, 253, 55, 113, 136, 206, 4, 66, 141, 203, 1, 71, 130, 196, 14, 72, 135, 193, 11, 77, 156, 218, 16, 86, 153, 223, 21, 83, 150, 208, 26, 92, 147, 213, 31, 89, 240, 182, 124, 58, 245, 179, 121, 63, 250, 188, 118, 48, 255, 185, 115, 53, 228, 162, 104, 46, 225, 167, 109, 43, 238, 168, 98, 36, 235, 173, 103, 33, 216, 158, 84, 18, 221, 155, 81, 23, 210, 148, 94, 24, 215, 145, 91, 29, 204, 138, 64, 6, 201, 143, 69, 3, 198, 128, 74, 12, 195, 133, 79, 9])
M37 = SBox([0, 37, 74, 111, 148, 177, 222, 251, 53, 16, 127, 90, 161, 132, 235, 206, 106, 79, 32, 5, 254, 219, 180, 145, 95, 122, 21, 48, 203, 238, 129, 164, 212, 241, 158, 187, 64, 101, 10, 47, 225, 196, 171, 142, 117, 80, 63, 26, 190, 155, 244, 209, 42, 15, 96, 69, 139, 174, 193, 228, 31, 58, 85, 112, 181, 144, 255, 218, 33, 4, 107, 78, 128, 165, 202, 239, 20, 49, 94, 123, 223, 250, 149, 176, 75, 110, 1, 36, 234, 207, 160, 133, 126, 91, 52, 17, 97, 68, 43, 14, 245, 208, 191, 154, 84, 113, 30, 59, 192, 229, 138, 175, 11, 46, 65, 100, 159, 186, 213, 240, 62, 27, 116, 81, 170, 143, 224, 197, 119, 82, 61, 24, 227, 198, 169, 140, 66, 103, 8, 45, 214, 243, 156, 185, 29, 56, 87, 114, 137, 172, 195, 230, 40, 13, 98, 71, 188, 153, 246, 211, 163, 134, 233, 204, 55, 18, 125, 88, 150, 179, 220, 249, 2, 39, 72, 109, 201, 236, 131, 166, 93, 120, 23, 50, 252, 217, 182, 147, 104, 77, 34, 7, 194, 231, 136, 173, 86, 115, 28, 57, 247, 210, 189, 152, 99, 70, 41, 12, 168, 141, 226, 199, 60, 25, 118, 83, 157, 184, 215, 242, 9, 44, 67, 102, 22, 51, 92, 121, 130, 167, 200, 237, 35, 6, 105, 76, 183, 146, 253, 216, 124, 89, 54, 19, 232, 205, 162, 135, 73, 108, 3, 38, 221, 248, 151, 178])
M155 = SBox([0, 155, 43, 176, 86, 205, 125, 230, 172, 55, 135, 28, 250, 97, 209, 74, 69, 222, 110, 245, 19, 136, 56, 163, 233, 114, 194, 89, 191, 36, 148, 15, 138, 17, 161, 58, 220, 71, 247, 108, 38, 189, 13, 150, 112, 235, 91, 192, 207, 84, 228, 127, 153, 2, 178, 41, 99, 248, 72, 211, 53, 174, 30, 133, 9, 146, 34, 185, 95, 196, 116, 239, 165, 62, 142, 21, 243, 104, 216, 67, 76, 215, 103, 252, 26, 129, 49, 170, 224, 123, 203, 80, 182, 45, 157, 6, 131, 24, 168, 51, 213, 78, 254, 101, 47, 180, 4, 159, 121, 226, 82, 201, 198, 93, 237, 118, 144, 11, 187, 32, 106, 241, 65, 218, 60, 167, 23, 140, 18, 137, 57, 162, 68, 223, 111, 244, 190, 37, 149, 14, 232, 115, 195, 88, 87, 204, 124, 231, 1, 154, 42, 177, 251, 96, 208, 75, 173, 54, 134, 29, 152, 3, 179, 40, 206, 85, 229, 126, 52, 175, 31, 132, 98, 249, 73, 210, 221, 70, 246, 109, 139, 16, 160, 59, 113, 234, 90, 193, 39, 188, 12, 151, 27, 128, 48, 171, 77, 214, 102, 253, 183, 44, 156, 7, 225, 122, 202, 81, 94, 197, 117, 238, 8, 147, 35, 184, 242, 105, 217, 66, 164, 63, 143, 20, 145, 10, 186, 33, 199, 92, 236, 119, 61, 166, 22, 141, 107, 240, 64, 219, 212, 79, 255, 100, 130, 25, 169, 50, 120, 227, 83, 200, 46, 181, 5, 158])
M179 = SBox([0, 179, 123, 200, 246, 69, 141, 62, 241, 66, 138, 57, 7, 180, 124, 207, 255, 76, 132, 55, 9, 186, 114, 193, 14, 189, 117, 198, 248, 75, 131, 48, 227, 80, 152, 43, 21, 166, 110, 221, 18, 161, 105, 218, 228, 87, 159, 44, 28, 175, 103, 212, 234, 89, 145, 34, 237, 94, 150, 37, 27, 168, 96, 211, 219, 104, 160, 19, 45, 158, 86, 229, 42, 153, 81, 226, 220, 111, 167, 20, 36, 151, 95, 236, 210, 97, 169, 26, 213, 102, 174, 29, 35, 144, 88, 235, 56, 139, 67, 240, 206, 125, 181, 6, 201, 122, 178, 1, 63, 140, 68, 247, 199, 116, 188, 15, 49, 130, 74, 249, 54, 133, 77, 254, 192, 115, 187, 8, 171, 24, 208, 99, 93, 238, 38, 149, 90, 233, 33, 146, 172, 31, 215, 100, 84, 231, 47, 156, 162, 17, 217, 106, 165, 22, 222, 109, 83, 224, 40, 155, 72, 251, 51, 128, 190, 13, 197, 118, 185, 10, 194, 113, 79, 252, 52, 135, 183, 4, 204, 127, 65, 242, 58, 137, 70, 245, 61, 142, 176, 3, 203, 120, 112, 195, 11, 184, 134, 53, 253, 78, 129, 50, 250, 73, 119, 196, 12, 191, 143, 60, 244, 71, 121, 202, 2, 177, 126, 205, 5, 182, 136, 59, 243, 64, 147, 32, 232, 91, 101, 214, 30, 173, 98, 209, 25, 170, 148, 39, 239, 92, 108, 223, 23, 164, 154, 41, 225, 82, 157, 46, 230, 85, 107, 216, 16, 163])
M242 = SBox([0, 242, 249, 11, 239, 29, 22, 228, 195, 49, 58, 200, 44, 222, 213, 39, 155, 105, 98, 144, 116, 134, 141, 127, 88, 170, 161, 83, 183, 69, 78, 188, 43, 217, 210, 32, 196, 54, 61, 207, 232, 26, 17, 227, 7, 245, 254, 12, 176, 66, 73, 187, 95, 173, 166, 84, 115, 129, 138, 120, 156, 110, 101, 151, 86, 164, 175, 93, 185, 75, 64, 178, 149, 103, 108, 158, 122, 136, 131, 113, 205, 63, 52, 198, 34, 208, 219, 41, 14, 252, 247, 5, 225, 19, 24, 234, 125, 143, 132, 118, 146, 96, 107, 153, 190, 76, 71, 181, 81, 163, 168, 90, 230, 20, 31, 237, 9, 251, 240, 2, 37, 215, 220, 46, 202, 56, 51, 193, 172, 94, 85, 167, 67, 177, 186, 72, 111, 157, 150, 100, 128, 114, 121, 139, 55, 197, 206, 60, 216, 42, 33, 211, 244, 6, 13, 255, 27, 233, 226, 16, 135, 117, 126, 140, 104, 154, 145, 99, 68, 182, 189, 79, 171, 89, 82, 160, 28, 238, 229, 23, 243, 1, 10, 248, 223, 45, 38, 212, 48, 194, 201, 59, 250, 8, 3, 241, 21, 231, 236, 30, 57, 203, 192, 50, 214, 36, 47, 221, 97, 147, 152, 106, 142, 124, 119, 133, 162, 80, 91, 169, 77, 191, 180, 70, 209, 35, 40, 218, 62, 204, 199, 53, 18, 224, 235, 25, 253, 15, 4, 246, 74, 184, 179, 65, 165, 87, 92, 174, 137, 123, 112, 130, 102, 148, 159, 109])
M251 = SBox([0, 251, 235, 16, 203, 48, 32, 219, 139, 112, 96, 155, 64, 187, 171, 80, 11, 240, 224, 27, 192, 59, 43, 208, 128, 123, 107, 144, 75, 176, 160, 91, 22, 237, 253, 6, 221, 38, 54, 205, 157, 102, 118, 141, 86, 173, 189, 70, 29, 230, 246, 13, 214, 45, 61, 198, 150, 109, 125, 134, 93, 166, 182, 77, 44, 215, 199, 60, 231, 28, 12, 247, 167, 92, 76, 183, 108, 151, 135, 124, 39, 220, 204, 55, 236, 23, 7, 252, 172, 87, 71, 188, 103, 156, 140, 119, 58, 193, 209, 42, 241, 10, 26, 225, 177, 74, 90, 161, 122, 129, 145, 106, 49, 202, 218, 33, 250, 1, 17, 234, 186, 65, 81, 170, 113, 138, 154, 97, 88, 163, 179, 72, 147, 104, 120, 131, 211, 40, 56, 195, 24, 227, 243, 8, 83, 168, 184, 67, 152, 99, 115, 136, 216, 35, 51, 200, 19, 232, 248, 3, 78, 181, 165, 94, 133, 126, 110, 149, 197, 62, 46, 213, 14, 245, 229, 30, 69, 190, 174, 85, 142, 117, 101, 158, 206, 53, 37, 222, 5, 254, 238, 21, 116, 143, 159, 100, 191, 68, 84, 175, 255, 4, 20, 239, 52, 207, 223, 36, 127, 132, 148, 111, 180, 79, 95, 164, 244, 15, 31, 228, 63, 196, 212, 47, 98, 153, 137, 114, 169, 82, 66, 185, 233, 18, 2, 249, 34, 217, 201, 50, 105, 146, 130, 121, 162, 89, 73, 178, 226, 25, 9, 242, 41, 210, 194, 57])
M169 = SBox([0, 169, 79, 230, 158, 55, 209, 120, 33, 136, 110, 199, 191, 22, 240, 89, 66, 235, 13, 164, 220, 117, 147, 58, 99, 202, 44, 133, 253, 84, 178, 27, 132, 45, 203, 98, 26, 179, 85, 252, 165, 12, 234, 67, 59, 146, 116, 221, 198, 111, 137, 32, 88, 241, 23, 190, 231, 78, 168, 1, 121, 208, 54, 159, 21, 188, 90, 243, 139, 34, 196, 109, 52, 157, 123, 210, 170, 3, 229, 76, 87, 254, 24, 177, 201, 96, 134, 47, 118, 223, 57, 144, 232, 65, 167, 14, 145, 56, 222, 119, 15, 166, 64, 233, 176, 25, 255, 86, 46, 135, 97, 200, 211, 122, 156, 53, 77, 228, 2, 171, 242, 91, 189, 20, 108, 197, 35, 138, 42, 131, 101, 204, 180, 29, 251, 82, 11, 162, 68, 237, 149, 60, 218, 115, 104, 193, 39, 142, 246, 95, 185, 16, 73, 224, 6, 175, 215, 126, 152, 49, 174, 7, 225, 72, 48, 153, 127, 214, 143, 38, 192, 105, 17, 184, 94, 247, 236, 69, 163, 10, 114, 219, 61, 148, 205, 100, 130, 43, 83, 250, 28, 181, 63, 150, 112, 217, 161, 8, 238, 71, 30, 183, 81, 248, 128, 41, 207, 102, 125, 212, 50, 155, 227, 74, 172, 5, 92, 245, 19, 186, 194, 107, 141, 36, 187, 18, 244, 93, 37, 140, 106, 195, 154, 51, 213, 124, 4, 173, 75, 226, 249, 80, 182, 31, 103, 206, 40, 129, 216, 113, 151, 62, 70, 239, 9, 160])
M199 = SBox([0, 199, 147, 84, 59, 252, 168, 111, 118, 177, 229, 34, 77, 138, 222, 25, 236, 43, 127, 184, 215, 16, 68, 131, 154, 93, 9, 206, 161, 102, 50, 245, 197, 2, 86, 145, 254, 57, 109, 170, 179, 116, 32, 231, 136, 79, 27, 220, 41, 238, 186, 125, 18, 213, 129, 70, 95, 152, 204, 11, 100, 163, 247, 48, 151, 80, 4, 195, 172, 107, 63, 248, 225, 38, 114, 181, 218, 29, 73, 142, 123, 188, 232, 47, 64, 135, 211, 20, 13, 202, 158, 89, 54, 241, 165, 98, 82, 149, 193, 6, 105, 174, 250, 61, 36, 227, 183, 112, 31, 216, 140, 75, 190, 121, 45, 234, 133, 66, 22, 209, 200, 15, 91, 156, 243, 52, 96, 167, 51, 244, 160, 103, 8, 207, 155, 92, 69, 130, 214, 17, 126, 185, 237, 42, 223, 24, 76, 139, 228, 35, 119, 176, 169, 110, 58, 253, 146, 85, 1, 198, 246, 49, 101, 162, 205, 10, 94, 153, 128, 71, 19, 212, 187, 124, 40, 239, 26, 221, 137, 78, 33, 230, 178, 117, 108, 171, 255, 56, 87, 144, 196, 3, 164, 99, 55, 240, 159, 88, 12, 203, 210, 21, 65, 134, 233, 46, 122, 189, 72, 143, 219, 28, 115, 180, 224, 39, 62, 249, 173, 106, 5, 194, 150, 81, 97, 166, 242, 53, 90, 157, 201, 14, 23, 208, 132, 67, 44, 235, 191, 120, 141, 74, 30, 217, 182, 113, 37, 226, 251, 60, 104, 175, 192, 7, 83, 148])
M198 = SBox([0, 198, 145, 87, 63, 249, 174, 104, 126, 184, 239, 41, 65, 135, 208, 22, 252, 58, 109, 171, 195, 5, 82, 148, 130, 68, 19, 213, 189, 123, 44, 234, 229, 35, 116, 178, 218, 28, 75, 141, 155, 93, 10, 204, 164, 98, 53, 243, 25, 223, 136, 78, 38, 224, 183, 113, 103, 161, 246, 48, 88, 158, 201, 15, 215, 17, 70, 128, 232, 46, 121, 191, 169, 111, 56, 254, 150, 80, 7, 193, 43, 237, 186, 124, 20, 210, 133, 67, 85, 147, 196, 2, 106, 172, 251, 61, 50, 244, 163, 101, 13, 203, 156, 90, 76, 138, 221, 27, 115, 181, 226, 36, 206, 8, 95, 153, 241, 55, 96, 166, 176, 118, 33, 231, 143, 73, 30, 216, 179, 117, 34, 228, 140, 74, 29, 219, 205, 11, 92, 154, 242, 52, 99, 165, 79, 137, 222, 24, 112, 182, 225, 39, 49, 247, 160, 102, 14, 200, 159, 89, 86, 144, 199, 1, 105, 175, 248, 62, 40, 238, 185, 127, 23, 209, 134, 64, 170, 108, 59, 253, 149, 83, 4, 194, 212, 18, 69, 131, 235, 45, 122, 188, 100, 162, 245, 51, 91, 157, 202, 12, 26, 220, 139, 77, 37, 227, 180, 114, 152, 94, 9, 207, 167, 97, 54, 240, 230, 32, 119, 177, 217, 31, 72, 142, 129, 71, 16, 214, 190, 120, 47, 233, 255, 57, 110, 168, 192, 6, 81, 151, 125, 187, 236, 42, 66, 132, 211, 21, 3, 197, 146, 84, 60, 250, 173, 107])


# [x0 + y1
#  x1 + y2
#  x2 + y3
#  x3 + y0 + y4
#  x4 + y0 + y5
#  x5 + y0 + y6
#  x6 + y7
#  x7 + y0]
# ----------------------

MULT2 = Matrix(K2,[
	[ 0, 1]+[0]*6,
	[ 0, 0, 1]+[0]*5,
	[0]*3+[1]+[0]*4,
	[1]+[0]*3+[1]+[0]*3,
	[1]+[0]*4+[1]+[0]*2,
	[1]+[0]*5+[1]+[0]*1,
	[0]*7+[1],
	[1]+[0]*7
])

# [x0 + y7
#  x1 + y0
#  x2 + y1
#  x3 + y2
#  x4 + y3 + y7
#  x5 + y4 + y7
#  x6 + y5 + y7
#  x7 + y6]
# ----------------------
MULT142 = Matrix(K2,[
	[0]*7+[1],
	[1]+[0]*7,
	[0,1]+[0]*6,
	[0,0,1]+[0]*5,
	[0]*3+[1]+[0]*3+[1],
	[0]*4+[1]+[0]*2+[1],
	[0]*5+[1]+[0]*1+[1],
	[0]*6+[1,0],
])
# [x0 + y6
#  x1 + y7
#  x2 + y0
#  x3 + y1
#  x4 + y2 + y6
#  x5 + y3 + y6 + y7
#  x6 + y4 + y6 + y7
#  x7 + y5 + y7]
# ----------------------
MULT71 = Matrix(K2,[
	[0]*6+[1,0],
	[0]*7+[1],
	[1]+[0]*7,
	[0,1]+[0]*6,
	[0,0,1,0,0,0,1,0],
	[0,0,0,1,0,0,1,1],
	[0,0,0,0,1,0,1,1],
	[0,0,0,0,0,1,0,1]
])

# [x0 + y0 + y4
#  x1 + y0 + y1 + y5
#  x2 + y0 + y1 + y2 + y6
#  x3 + y1 + y2 + y3 + y7
#  x4 + y0 + y2 + y3
#  x5 + y1 + y3
#  x6 + y2
#  x7 + y3]
# ----------------------

MULT16 = Matrix(K2,[
	[1,0,0,0,1,0,0,0],
	[1,1,0,0,0,1,0,0],
	[1,1,1,0,0,0,1,0],
	[0,1,1,1,0,0,0,1],
	[1,0,1,1,0,0,0,0],
	[0,1,0,1,0,0,0,0],
	[0,0,1,0,0,0,0,0],
	[0,0,0,1,0,0,0,0]
])
# [x0 + y0 + y6
#  x1 + y1 + y7
#  x2 + y0 + y2
#  x3 + y1 + y3
#  x4 + y2 + y4 + y6
#  x5 + y3 + y5 + y6 + y7
#  x6 + y4 + y7
#  x7 + y5]
# ----------------------
MULT70 = Matrix(K2,[
	[1,0,0,0,0,0,1,0],
	[0,1,0,0,0,0,0,1],
	[1,0,1,0,0,0,0,0],
	[0,1,0,1,0,0,0,0],
	[0,0,1,0,1,0,1,0],
	[0,0,0,1,0,1,1,1],
	[0,0,0,0,1,0,0,1],
	[0,0,0,0,0,1,0,0]
])
# [x0 + y1 + y2 + y5
#  x1 + y0 + y2 + y3 + y6
#  x2 + y0 + y1 + y3 + y4 + y7
#  x3 + y0 + y1 + y2 + y4 + y5
#  x4 + y3 + y6
#  x5 + y0 + y1 + y2 + y4 + y5 + y7
#  x6 + y0 + y3 + y6
#  x7 + y0 + y1 + y4 + y7]
# ----------------------
MULT37 = Matrix(K2,[
	[0,1,1,0,0,1,0,0],
	[1,0,1,1,0,0,1,0],
	[1,1,0,1,1,0,0,1],
	[1,1,1,0,1,1,0,0],
	[0,0,0,1,0,0,1,0],
	[1,1,1,0,1,1,0,1],
	[1,0,0,1,0,0,1,0],
	[1,1,0,0,1,0,0,1]
])
# [x0 + y2 + y4 + y7
#  x1 + y3 + y5
#  x2 + y4 + y6
#  x3 + y0 + y5 + y7
#  x4 + y1 + y2 + y4 + y6 + y7
#  x5 + y3 + y4 + y5
#  x6 + y0 + y2 + y5 + y6 + y7
#  x7 + y1 + y3 + y6 + y7]
# ----------------------
MULT155 = Matrix(K2,[
	[0,0,1,0,1,0,0,1],
	[0,0,0,1,0,1,0,0],
	[0,0,0,0,1,0,1,0],
	[1,0,0,0,0,1,0,1],
	[0,1,1,0,1,0,1,1],
	[0,0,0,1,1,1,0,0],
	[1,0,1,0,0,1,1,1],
	[0,1,0,1,0,0,1,1]
])
# [x0 + y0 + y1 + y2 + y3 + y4 + y5 + y7
#  x1 + y1 + y2 + y3 + y4 + y5 + y6
#  x2 + y0 + y2 + y3 + y4 + y5 + y6 + y7
#  x3 + y1 + y3 + y4 + y5 + y6 + y7
#  x4 + y0 + y1 + y3 + y6
#  x5 + y3 + y5
#  x6 + y0 + y1 + y2 + y3 + y5 + y6 + y7
#  x7 + y0 + y1 + y2 + y3 + y4 + y6 + y7]
# ----------------------
MULT179 = Matrix(K2,[
	[1,1,1,1,1,1,0,1],
	[0,1,1,1,1,1,1,0],
	[1,0,1,1,1,1,1,1],
	[0,1,0,1,1,1,1,1],
	[1,1,0,1,0,0,1,0],
	[0,0,0,1,0,1,0,0],
	[1,1,1,1,0,1,1,1],
	[1,1,1,1,1,0,1,1]
])
# [x0 + y0 + y3 + y4 + y5 + y6 + y7
#  x1 + y1 + y4 + y5 + y6 + y7
#  x2 + y0 + y2 + y5 + y6 + y7
#  x3 + y1 + y3 + y6 + y7
#  x4 + y0 + y2 + y3 + y5 + y6
#  x5 + y0 + y1 + y5
#  x6 + y1 + y2 + y3 + y4 + y5 + y7
#  x7 + y2 + y3 + y4 + y5 + y6]
# ----------------------
MULT242 = Matrix(K2, [
	[1,0,0,1,1,1,1,1],
	[0,1,0,0,1,1,1,1],
	[1,0,1,0,0,1,1,1],
	[0,1,0,1,0,0,1,1],
	[1,0,1,1,0,1,1,0],
	[1,1,0,0,0,1,0,0],
	[0,1,1,1,1,1,0,1],
	[0,0,1,1,1,1,1,0]
])
# [x0 + y4 + y5 + y6 + y7
#  x1 + y0 + y5 + y6 + y7
#  x2 + y1 + y6 + y7
#  x3 + y0 + y2 + y7
#  x4 + y0 + y1 + y3 + y4 + y5 + y6 + y7
#  x5 + y1 + y2
#  x6 + y2 + y3 + y4 + y5 + y6 + y7
#  x7 + y3 + y4 + y5 + y6 + y7]
# ----------------------
MULT251 = Matrix(K2, [
	[0,0,0,0,1,1,1,1],
	[1,0,0,0,0,1,1,1],
	[0,1,0,0,0,0,1,1],
	[1,0,1,0,0,0,0,1],
	[1,1,0,1,1,1,1,1],
	[0,1,1,0,0,0,0,0],
	[0,0,1,1,1,1,1,1],
	[0,0,0,1,1,1,1,1]
])
# [x0 + y2 + y5 + y7
#  x1 + y3 + y6
#  x2 + y0 + y4 + y7
#  x3 + y1 + y5
#  x4 + y0 + y5 + y6 + y7
#  x5 + y1 + y2 + y5 + y6
#  x6 + y0 + y3 + y5 + y6
#  x7 + y1 + y4 + y6 + y7]
# ----------------------
MULT169 = Matrix(K2,[
	[0,0,1,0,0,1,0,1],
	[0,0,0,1,0,0,1,0],
	[1,0,0,0,1,0,0,1],
	[0,1,0,0,0,1,0,0],
	[1,0,0,0,0,1,1,1],
	[0,1,1,0,0,1,1,0],
	[1,0,0,1,0,1,1,0],
	[0,1,0,0,1,0,1,1]
])
# [x0 + y1 + y2 + y3 + y6 + y7
#  x1 + y2 + y3 + y4 + y7
#  x2 + y0 + y3 + y4 + y5
#  x3 + y0 + y1 + y4 + y5 + y6
#  x4 + y3 + y5
#  x5 + y1 + y2 + y3 + y4 + y7
#  x6 + y0 + y1 + y4 + y5 + y6 + y7
#  x7 + y0 + y1 + y2 + y5 + y6 + y7]
# ----------------------
MULT199 = Matrix(K2,[
	[0,1,1,1,0,0,1,1],
	[0,0,1,1,1,0,0,1],
	[1,0,0,1,1,1,0,0],
	[1,1,0,0,1,1,1,0],
	[0,0,0,1,0,1,0,0],
	[0,1,1,1,1,0,0,1],
	[1,1,0,0,1,1,1,1],
	[1,1,1,0,0,1,1,1]
])
# [x0 + y0 + y1 + y2 + y3 + y6 + y7
#  x1 + y1 + y2 + y3 + y4 + y7
#  x2 + y0 + y2 + y3 + y4 + y5
#  x3 + y0 + y1 + y3 + y4 + y5 + y6
#  x4 + y3 + y4 + y5
#  x5 + y1 + y2 + y3 + y4 + y5 + y7
#  x6 + y0 + y1 + y4 + y5 + y7
#  x7 + y0 + y1 + y2 + y5 + y6]
# ----------------------
MULT198 = Matrix(K2,[
	[1,1,1,1,0,0,1,1],
	[0,1,1,1,1,0,0,1],
	[1,0,1,1,1,1,0,0],
	[1,1,0,1,1,1,1,0],
	[0,0,0,1,1,1,0,0],
	[0,1,1,1,1,1,0,1],
	[1,1,0,0,1,1,0,1],
	[1,1,1,0,0,1,1,0]
])

L = [MULT2,MULT142,MULT71,MULT16,MULT70,MULT37,MULT155,MULT179,MULT242,MULT251,MULT169,MULT199,MULT198]
L2 = [M2,M142,M71,M16,M70,M37,M155,M179,M242,M251,M169,M199,M198]
# print(len(L),len(L2))

# assert verif_mult(L,L2)

R = [Matrix.identity(8),Matrix.identity(8),MULT2,MULT142,MULT71,MULT16,Matrix.identity(8),MULT70]
M_mix_partial = block_matrix([ R[-i:]+R[:-i] for i in range(8)])
M_mix = Matrix.block_diagonal([M_mix_partial,M_mix_partial])
# print(M_mix.dimensions())
# print(test_mult(M_mix_partial))

SBOX = SBox(SBOX)

# SBox op
# [x0 + y1 + y6,
#  x1 + y0 + y3 + y5 + y7,
#  x2 + y1 + y2 + y6,
#  x3 + y3,
#  x4 + y2 + y3 + y4 + y6 + y7,
#  x5 + y3 + y6 + y7,
#  x6 + y0 + y2 + y6 + y7,
#  x7 + y0 + y4 + y6]

M_sbox = Matrix(K2,[
	[0, 1, 0, 0, 0, 0, 1, 0],
	[1, 0, 0, 1, 0, 1, 0, 1],
	[0, 1, 1, 0, 0, 0, 1, 0],
	[0, 0, 0, 1, 0, 0, 0 ,0],
	[0, 0, 1, 1, 1, 0, 1, 1],
	[0, 0, 0, 1, 0, 0, 1, 1],
	[1, 0, 1, 0, 0, 0, 1, 1],
	[1, 0, 0, 0, 1, 0, 1, 0]
])


M_sub = Matrix.block_diagonal([M_sbox]*16)
T = Matrix.identity(16)[::-1]
T = block_matrix([[int(T[j][i])*Matrix.identity(8) for i in range(16)] for j in range(16)])
M_sub = M_sub


# print("constructed matrix :")
# print("\tM_sub",M_sub.dimensions())
# print("\tM_mix",M_mix.dimensions())
# print("\tM_shuffle",M_shuffle.dimensions())

M_round = M_mix*M_shuffle*M_sub
#M_round_inv = M_round.inverse()



#######################
# Key expansion
#######################

KEXP = SBox(KEXP)
# print(KEXP.inverse().polynomials(groebner=True))


#  x0 + y0 + y1 + y2
#  x1 + y2 + y4 + y5
#  x2 + y0 + y2 + y3
#  x3 + y2 + y7
#  x4 + y0 + y2 + y3 + y4 + y5 + y6 + y7
#  x5 + y0 + y1 + y3 + y5 + y6
#  x6 + y0 + y3 + y5 + y6 + y7
#  x7 + y0 + y7

M_ksub = Matrix(K2,[
	[1,1,1,0,0,0,0,0],
	[0,0,1,0,1,1,0,0],
	[1,0,1,1,0,0,0,0],
	[0,0,1,0,0,0,0,1],
	[1,0,1,1,1,1,1,1],
	[1,1,0,1,0,1,1,0],
	[1,0,0,1,0,1,1,1],
	[1,0,0,0,0,0,0,1]
])

M_key_exp=[Matrix.identity(128)]
for k in range(10):
	
	T = Matrix(K2,[[0]*(15-k+i)+[1]+[0]*(-i+k) for i in range(k+1)]+[[0]*i+[1]+[0]*(15-i) for i in range(15-k)])
	M_key_exp_tmp = block_matrix([[T[i][j]*Matrix.identity(8) for j in range(16)] for i in range(16)])*M_key_exp[-1]
	M_key_exp_tmp = Matrix.block_diagonal([M_sbox]*8+[Matrix.identity(8)]*8)*M_key_exp_tmp
	T = Matrix.identity(16)[::-1]
	M_key_exp_tmp = block_matrix([[T[i][j]*Matrix.identity(8) for j in range(16)] for i in range(16)])*M_key_exp_tmp
	M_key_exp_tmp = Matrix.block_diagonal([M_ksub]*8+[Matrix.identity(8)]*8)*M_key_exp_tmp

	M_key_exp.append(M_key_exp_tmp)



# eq : R^10*P + (\sum_{k=0}^{10} R^{10-k}S_k)*K_0 = C
# R = M_round, S = M_key_exp, C = ciphertext
# A = (\sum_{k=0}^{10} R^{10-k}S^k)
# B = C+R^10*P

#####################
# Attaque du symétrique à travers l'asymétrique
#####################

def matrixMul(A,V,Corr,n):
	O = [Corr[0] for i in range(len(V))]
	for i in range(len(V)):
		for j in range(len(V)):
			#print(int(A[i][j]),V[j])
			if int(A[i][j])==1:
				O[i] *= V[j]
			else:
				O[i] *= Corr[0]
			O[i] = O[i]%n
	return O


def add(V1,V2,n):
	return [(a*b)%n for a,b in zip(V1,V2)]

def encrypt_sym(K_enc,P,Corr,n):
	A = Matrix(K2,[[0]*128]*128)
	R_10 = M_round**10
	for k in range(11):
		A += M_round**(10-k)*M_key_exp[k]
	P = [Corr[int(P[i])] for i in range(len(P))]
	RP = matrixMul(R_10,P,Corr,n)
	XK = matrixMul(A,K_enc,Corr,n)
	return add(RP,XK,n)[::-1]

def decrypt_sym(K_enc,C,Corr,n):
	A = Matrix(K2,[[0]*128]*128)
	for k in range(11):
		A += M_round**(10-k)*M_key_exp[k]
	R_inv_10 = (M_round.inverse())**10
	C = [Corr[int(C[i])] for i in range(len(C))]
	XK = matrixMul(A,K_enc,Corr,n)
	return matrixMul(R_inv_10,add(XK,C,n),Corr,n)[::-1]

def crack(P,C,Corr,n):
	P = P[::-1]
	C = C[::-1]
	A = Matrix(K2,[[0]*128]*128)
	for k in range(11):
		A += M_round**(10-k)*M_key_exp[k]
	R_10 = M_round**10   
	RP = matrixMul(R_10,P,Corr,n)
	Y = add(RP,C,n)
	A_e = A.echelon_form()
	T = A.solve_left(A_e)
	S = matrixMul(T,Y,Corr,n)
	return S

def crack2(P,C):
	P = int2block(int.from_bytes(P))
	C = int2block(int.from_bytes(C))
	A = Matrix(K2,[[0]*128]*128)
	for k in range(11):
		A += M_round**(10-k)*M_key_exp[k]
	R_10 = M_round**10
	Y = C+R_10*P
	return bytes(block2int(A.solve_right(Y)))

if __name__ == "__main__":
    # C = ciphertext, P = plaintext associé les deux étant chiffrés par l'asymétrique
    C = [80098575931106018267302757294105123846717310030697917614497420275707563734363932606920600910769261204031746277085352599253768314551625047853337615336403901024970043046664233760811636826960063140558182170180230052826496859464374404921238332987787529085393228715631428295862785453393185691999193953003590982060, 22029947620188283151567893897447579445480990677709795952227970781311031412286060591174417489914756983226578562463100511684602325514376479717846953600230830538816501568120877840130957044018290873350450598606354752826455750425660656546882930869678621777225608053439303049594796765696981991075364543662690974493, 64122706786096448484825663446444962972293411976321784569753809826489686851258191794727973929883700256980969126575355798681704341354787739169453348710190872161081016324362757694562219551209421569343394456036246618775507205666603712494715326796198923221638513084668178788342682540440401783843315161324008196565, 111065737621630652205618861782159786453568256366225213356982264779983138824155584741369797882119994827022658712760563129728343494161608195902369532835991334976413048589436575693398807022700146829941634562606808290762930564570164530695849089104989842847811099389870714756021170700155533604992067467835027519263, 6319980208145468507406887944104257198322480058368503267781042602195647452661890120004759642227245266951902458160909658488678674284781022154616499957718122054505878225354334872966255548014558993004825831099576952588310735482861656371085699619261177312595023688547404348372149441800140707126364699914127406083, 93146254956202037834945268812817746603479120819934366695152681777090451055988978967180627602695639157935089746785704212067327393792405167034226868255947194141716288841705730696482364214199847141507546686450535788967363810224679631298998515593148222592356706665633139834430446902183071817874266950597088326258, 50753349644478620391802002708593196910140960225788903117152426578623956704498937364079871903435486089640578601204177275062783426103408357898627747103639121525019342553561865843131881098014077668530006915228598107985859135819058250795405361031433017103897190952451132474212426286603867928807849186295314163744, 23580305419387295699991283547437249513125462393913909715216013888625422294858037058988451948837970142113950515679144112683557429679138535968516693854064046929096668673127115046226763523493703405566262528799204337265118912769471319622787113780125468060442922844265069490451846879405738923485939114548217878604, 78706268595155272413345095669627798830072664669869836470504521176480740103359444066353596431972246637289598160186775264593919672843144281966346541011569038804787261770160046822055564501717426069246148434823669458388702614529334494161422135678752474274240509766325286154791930921299432744346500172049585418371, 14825635889826848491381495908238882707477675394880236324388714497527880733399409284631183435720842554184956604031458777337954008604384354298759024247630854647422026241281568095630321037130789388125690549099004564243451671108333362671036097703851059059782014958152197817018600101542266934667993602168085647746, 121202902827412680357946417016586009741171188403693134618417970876931552784516428032631723175866777549208185917886111892801830035625934840083754603487982261175722118685361643819138120360046583263578284965065944505458572049374092482461990370359376147533931247942092348137925939997958905736893414490256866045402, 50752656178107072369047688756957052497495945449079363453209037737785875020337360751222120586251353143191346804338693444917033350066689159698555004950339653079187907366631130364382274744246049303859518945344713373327801123437847353142198696143666472384524878660525036951403460598031581175239131388123010691774, 55942109074894220958377852207992784529077451302321065226955960132467292637569915043449210791034108418802802444617545668499182135901696442252045749559159186374033882237058127816862164792728076450319972629290381496129881106516828410446662726529131821382686362477281230093721280965307091121310714841678913083889, 50971309076791104136135993420255746927281806904266809260909356650986054299622252819166748075133084114096914097394024352720002672956886672713810934589534943037023570628995529965517444479460496245649226250177428264659214785472352568830375914311173396393639681285282299554340015940084724723648499297575668942695, 66198137703456842626699657292280494596034125317337390429260970728750992276886858921134148844414131050698465558607068479363833445751838113690772074770880075745844839986761891994498293681304645408834062197521697353503168603315597629563282965888536041629834604077164123603407722690783574740550515184909010177516, 127347566814182770009879897882274647958893773456293840094996531893382132620385571965969860403110189478395344741316285425439123417374808667212670090458622467080281440592228576982478404719089711442775589759338830618749692026540060487409381565267071687063463576143940206561344703432791698646752577369252312594565, 52589623134822928790335598691272115880206215851072826341528633802522550583716264502812063715178472447448276966693870198540166118681017130948912911315990141310236771037230731211307876695292678062648457679586528747968500200746166131644539539456841577273518954885583117809252807160525574825161924830006766176810, 128704592775345239027260232955381683885630813311361896385798931619284139308451053842717147355369719893176554444288510223590982917675664732225745202682565815771183204961630559160249152833217244936452955132388944585842062291604536623504439869525070824437698294618116476530863088622112216826535427684261656511896, 79607853279195124657725018217835658094868424741252875636950624315365020098775452468243746889131249368461032834235523737856696999572679862786844864359417096969635695614106935328370044952511986299465555783084274149841422423542245855242380667371863294606745504843991974341468162473321877012672574869851347246389, 53607436060203993381928437651814766385851422277450721258490679919382756544811971387297455580411315222617941760215393617086935062983564164134763347460369009638226743625824383003726290376056800244415116525964730862325567717085549064029536082840533034767755589946320599693303267743673675555055393636750798077743, 114706444882873370630972539861186900997984251895220421854486822991409861560430513450104236496454495082561086477197153553977729288555211655773740711161214724183033850732925496376349082476457096816994719457797463611163562367299145782199763525939861387941541470929807390861257910103260504284201776028950189119717, 133501761048601790253911631543277710369824537151723267785935253797884131268083880223469427778784219673958557428566469895778882682676371226349209804811197604882584171944730875961578622176051099292542641155463169665151443222681434625448925972109089505500382712402812307691006195294093452112289691416994750376094, 96041555501666742825775910576225246593236534516950239740162130769289293787552835989697517157099816660950581918021821218068558123799702271573644611543349273676926819330774303305210457450718953478824823226148548173827310057903019805622914354753235263573119180692845538312727989807107641716141901995296877017009, 31584346792855095636039223956251750603591451229860225215654872006223317884081731482431440062912840128269442423412492875165274441330719662949299754750966396440260264123615032266865794776294930659810493714027964075302512565034049657290761374373416104676175424025673556550455698614528766466103586261284746913678, 100198807183853929649695029049777295505913483219175685318438731542486260826559549477232155896431607740245654423990310093433390723966028012391180962614266199899597281801508721756395239439385487183404047066440862605101325878644823614918034658648577895805192088052121889722779370198964807691816805372037006851803, 29078437731630207481311844357707156408230994911791795213642248342332241751920647669765234411641435158938337113009783310394222649021721027953424522262922497567090894706255555089600961137902094350519295799580221581975151791603632843746058088137056488297339838564917062047736846022520159219393944654698673585921, 26316446490973666617602657336065562796544978299461162005733964882646988224489546081455931485289075692911695149176098806414021501063623419972297229331709410442778298080953722603804750334819346375129921311215704754281896124432947548822471049909652758659259329432554589863412661057574117056032017649319105102380, 112300423046327600250862870365783246534067631755064382296599481502807177200290078649307430760254812250559614110061414973209330975313220471102831811826672505905751383883859902724672980756855022109259658951178269147142523733456294005665619920926212188848870925390779427880983529561450233806228487165351999679019, 123381969884741283012185979265706960695530770708407545379117402735392856485244239924300187068133869212225852985373116956760056178330573906748052221720450913801295183151120254439058730159974916382566089609054074107257117090322028884358585821128096859442054054720985903065718836430243684193318108216747737568057, 23615977400816382892060670002991013938865600530592259118158335090162782312648441976346827008130437091044902151639728845159727613372638145124133633117146312838223845772518400813325577673417408904895899865927004573256586181888441086990563301671170638568619901460503955068689531778876992461700327386253644686478, 34055890541213593454083262405895963485934167069531322876554944582412130284826098096287793271203126982834905198132671001095330592569617270392399732015648350242591179745205396003802412102681630004011374017410633940218358911791225761076167406411214376315044596519629749997478215580694816836149347222771328424334, 90490269366232284935510567725893973815945395151753603887510188199792509296700949924687950434703865593614132289403955042434256094798091075503355759389993535323147489849370443970202011942664810565242700588327391720091068337373225295539310812728614869500346658797602750790201226711200397743196893121259250395196, 93297337566350519196688557434494512174025578704401242499937412109150281960766188515342488715196040799044971330932535738011290836351725633134328198437871393580911005384098105459949106834577674349344884841926764920088669998627541575007923665573532267563800077816316609441655772725444345172549587553301742755473, 27652222773180826591871959411943309459177186453009914607749607318223368306781260951715097853005957960064634555079446510949044477498852970659610170458566515887683098838845026063050232558540676847460283286321807629490536153172206557278074689313976220792258879915600109299716684666188310593246398411381204862718, 87995855937813288762154327356498052123102598636624777655442528386474621005517047309038214973618187969029510503041754391781980593680138953835741459298028703228537695579174056569872548010610507972656534987164009685945350108041434589636661381670852736401096119877051110206477753789273485157301046374362083989757, 105083201935268883489612618337965400502683956358342941070624460525859764426520210164487104993568688163883388247148970710884333359883806314648202079509889237806566765123576893919198459943072598115653312569172403625540395309425031055921045397409589773656760677617790237508021552430982658686216734637300710472923, 3250774706788233069477068513357603791895817350905973655834759715424549348107663272656866611952592127606448267120950772065496162889929552998154101552000670817410340374815745897169800522870343651730720062255951856502624807452760626690768802088396412561352068963987728745903238103899587704134271886436052840352, 34246816084577589083848508540154713651882415113063239793653307904083529552047335734398912014699855832520434289445673607355157267513136908956564245989280016746717345322212622156481137764818585941343230619885467340056405963937971516031562118768350752040886304036241598497547229607179046031359780290222177615321, 43751380483170158281712463428894290459981325233318858748113080621684610425105398667997321712217326379127219358548078220229643599322274555749607028078927421420762195329717816192798782589746681260705570289281097778273758914724360956648555463243413290826643337864924184478147913200405265858176421977571346031216, 6588410973947029160808044671319511902029249958493876318470439695456287066916630976373471395657967083100080174548393765153706982298527760593717019595969963970610625699962306725798548163893387657813857356773759308320784158391487210189589908590233923184998873943732673994590796555542130941667437756663423045658, 110192440659996126870400772919654537872510623074411741614116205388719236559933900894796347802630346248652413028521774777043472801340405457368442252225616508223880090637437935135660006916551413088723412737089326159160247566466540813812666939599256151717609184271833580815397832127754047523087376001829627104214, 11946321499892393349978031385279061257172966438876850670418377467358199560063163837483134187835528119575975129184229860896552395784916342355994123743117541180339834762957651721006875085050753174057727131002993922435871859765425513310914879078004260826426099932689063399475030295256312653094939749508601902890, 10738168859222524447597659753772083213666906552790605816189962807445827340821875014867100903123176589132015302673987391872461461352619854726185420318914518353813119988086102854957741246913186277295953251796886196984715288058164300783232242380398500513632582245384259177046904368105496972623298447003044346523, 90706353636888242404925621559768741694895598471930432501970429484418453477066464022686177592187125812318388256280349270915882583453643197176055905241871414349802569347714499812132847358133530723553950938908890475401222120656807140113020130431745763157800300130955401101208377693354780617835302290823063269885, 39023452298458848108471268298418459575246812902826459750956813047462407047596810339776346963269460794835982980554633286495899073291852090386097434945204911132690635787774710705120756232125490728729479921508056820462624175476802134273042739610576729020027701363578774901680687808973479623347120200499324944340, 122843838955495840586722532012486385398902767770775377759575100249628664824098759165533904372259867913000138311328984750765599183741057939851367927420101390172253889264063568417709406320551855595239902233970305063485554501007462419190399564118959176621149959530499401885163009430759307567299694155460369512913, 125815312910796029745518307657395729766336513643886576846751255797425636609673343751304584692933000963622556965085142423583327013418122706334546644181940277721542259451056839288525468883491912017463032795104776524305513511472523004951634676124313451134592392563092189122239599684075315327039457037258644106532, 90356309466455126118064249104460069915642882935993993526178216645672541247558320351654599813920946414783690358312767130057811245441572973423313028204213307441363365943336763717380226309449396626511455312221651635799292044306248507858290805850349355385862784564601181847187683558154802796446406296747678021941, 71409102511031703846462509026966151796596882472161917643316677451279177354149650131013413800975584708545892853814576254634327972056148961139355938999855003894361047091822257696250433900532642461373017766592278686791425681591846803074964560514379106344066625056724633605789812176099622262652487935791418536200, 72035639692823833356787477339577491820763318421914136956057800635134520402475506042982508123250405845060941829343773904305515734452167077136627675813849702900728877548989722835372558079124066208973914650782157083166200753649917972693208449702629627766972752628737022916875687236514421197402641527527605889368, 29083972768457590239565839282710182454153372659716706871810163775507497530235930132010983874052984458940989789870039401799858116765311255573990434225021821076993404249111771313142767129317274888231895700828241611750153478100999860640208217236649677936649679949000781713697960118948678737451993655596970094803, 81381935709512154331790504225749735161245780637001195133590141011645579843807491811851004252619060706785470443954429398457767999260503127577385596897174454951261498743710581740536475983289890428081712240793433021660712086196455149365335303951420774800659101445839662162307407631020901111724477501048388483828, 44127867013672700928537426800585096721423234233143274881990435987530185593769574849732385800816821961784303107552950063192093843368764736517087920295638461508966850852952786922812295840559678138438990905274268539111068486694327556066304641194904462725722200323923734462897469637743269429722077608690176035609, 80140265961789449007779070398561554063969489305312762588383899193154376791263777864662630159693231499341948599380336361216961004907483973380010764699028211320120573698562434332852346805979743814705539751477725123893196147646999759863907799143250411818236191954046289542626710796636718219770111742794521851139, 109603398439240895801843111607090316249698384283392484186650395553323359761234894707514841847285165286206375428778170654018956990025411155805633771619862706621233365998992376874617689415400965891659614493826381169592808932568770880154231397568859627643838226012661133237434773606811355052991136347502857565393, 78978119487645520177778165391145210781280961160457835509998847004935610906971223500736897168928478436832383990862501577758626577745332188078001931332178980867629352394952919136490785253572440334583440192801610020859144976161027356203991387444584119566564867257341470020160426303659695507338603702071320748825, 78498390366661877069795748082474161182752488850808357840649202237625698211556036320915440899309171609999950427372295023170933414077807898486731744523257874795395486384263039378054654299163582318727948602863369665767711396535914990214596318656170894388473470479750356479440166585696348940998055076506753443325, 123840563463367301576415876133932972627650222347946914082198904697686932093307746656347688489746364943456163156592209429174297106571678075957488610124728033669810566282631925413791605555846026622325194113778844032559933324866057006504556831278763165064881798118490214502806675694423356059612854641168255871286, 29819891096575967437961612849958264149842295972904472355784649166502078805609087260204910760662596984664077720703934477770000375256109673851296177131139697515619341017487130779828611556033390920269943792692997281207726532687756650577422366780862071131950784678748570684786070494802960450356817065670547512869, 16541391963638952174473184392812245438556662155769012822442177671713650921304260674393304037050538135383064616270652546480134883853381484023371686466406679492251720182454680238280579240586016761447892342605921855583453475587779811963504670666458143202468670075347912949916265193744612516569251552044068740436, 69646552371760345481632911342165283541730931161991967548769469798044387942370580917015245920200197444308810975736244191734915602256048761225064539495669693704083892334844488275308632982565180574971469827671892526759810842182568056532721166157328354580736641332521949328481730664635691907447404582330173839588, 57892071401297722072359564358259379550760154409245996194027887103528360290016230706724065405515836613960531695164596651858071624682593611635404644904634252088665361660349879293990539443127177294504374447814874018962415499456705515564393979494568384317140320831835742339813231939220345748674782060471131664987, 114309726842013760218783755174881681089300445802435465382399777194461204487418297456864516518379582481740866392497449119298400302988196488011157458151589977658944657435135147274908142156164696675451167783941457170242007406859840018349351595816925571618918332281645023904095005619097087601002880142578896957466, 20770473571987901098221230616676962209815202082186707904031679396373986708709523396401799476934899746577203589963885714766898617804652239393558808935866251076761090406911910791383047256043820925068542076757938522838960592477464022228158243464966765488648552816407230130464053771281545351317416998496636557772, 68131216524767782167967352220499150475711804702454004691106244578029963463046594064395355432429947230538682877477810564699725187782882550114156410718819661260278285673220279875717265203004328589388837968953042780396633668349210778721442165708910622941666784836337532638707626827562331726417673289143949907204, 47130574295286417829405356241809563424825810093254024405609057641723879789931282275909796394106003344784816934165374651298771763067753280106303572646420596077254282576524717681867104572234832453890056511004466922533106613198548434096034626042853046212684169118741070056621468982124398582925243777453059235261, 96114165270434254540086057578879605971066465896556107880264273202269072401187608863043455906339068175766857909787709110735111101136180296175045675429552301055626131053527843821055375761874431212174547750852433537181341743036652963195173707144538209870998849856463921044451038887883408434064306814198012668214, 38494631845687712630586243542319211963935664003112911413740537736018623012840643093437945209002191641978606290572079710964390897278179361184712889186206136878213754130358911706461137740481479441250071750169231661900801176289447657865402358363186414431382419755472204327465929459142466997281656873047827273326, 132149393646727926090883587485533659649245867053428480466657071843519005712153329497731550553731797968780212413734136762185279998578093099822878483715398734430380837594457672522789729591338268291437868387411719164114254626786368961456090781926643035635567986271653628492140678334286733299056427007379784384830, 113603371730894030336116264067427472821024247846281529068653526927435855926856002900155688030093011401433662131249172859069615419597766295727745281863375442135758371742516853769063503616050938636467894747238924707794483158400978839058231341355343782247189185991373153052214358515474643723918569482597913159614, 47670758458219500604031812105822741009757432297725239208867629591978471770718235227400191955749591061691733964325611167639040608790417264373663293918834419300717728218140870614240166516222754804621566176811749944631747340934869576293867827119192006790342930555340008386251760724868366111754486147974374121252, 109921111285539009796157510032741310628173968615723946859913372661652281485911460719045646508267602011988650673731429766821165711595377671395407625571854194370405770399592385236277195316800567508984992333090332793967315860051460830021505805632402450844116484306519277677893555036838894249514314467606745086349, 23507230326944890933022292546705443344249154152405753250928591384910617387959261242514942392468147963630328398703868256691082097491647528745613551426100406810252176309088885207537948963597855990671505447371645460296923511216819973445289225357195078652384888900761403318302176416815147206491335015342793763469, 99108614408531281443227565352285506069313593142289001935094377320496105691811892886040734185951160550781607088463422609666815683218638864731418497549538814547929681309931222391544923551143905467759375789951040214527136699130220682759039180919631015112648049943031263546131434291319746306110569758434681158661, 117541006653813123698035668314178467565986175297676511870870443967335045077467956194874286237957987528957875092120449110225308524929550861803208868442847313343720700431700242128498987250941717528161878284876074285250040420152067681962690031002043194737495639109642722567538949758287387348315230397841804651463, 101114014413427917953952798516716066264231164966854881192428105610974706833590118417664213688477096802883958970468467553894214931885452776296682042966895427211307358119329685158831467593625721879790146893992547060845458433981489635653631474646636862712436366391270557656969464031378489578773300312950845303434, 58824122865644928400861473793056705149489486166047780955824619261819635957471757610234362970276954763129608622688346550872629298112003507171573357987384817625964173404551688981811602200027562753272860647786458017368999478137450931197680298269887479547839322779792307142061080551366013630948898220654131762828, 16947596828234280565331874742026015442921712742578979315762722977503134878129745132779961025071860149599469423889344375904078204204863290950853837368361999227479114516249494849273113849746090867694738906283235687144871516645986410377316396178029227111914080328990294926999996098994931835571373511552068764570, 123738460561982747427759733175952621895670809776953819402161317728345436958716483694118570785507585078661869684595295704677254352938398487209769143521762337800507695604168276148948437882453359157245793567947648911861418361571860437478413515030231599475563579531977390675988983590660192429151017100343084403660, 4904347271709090677584093524793367069411726660624080153162948414132613500441431724795852608024247219541428224316719272172604201661634419401251744124649832566625462199095335230268649359821641079713528436289454551084152828709579612101571448137728732941785742675915368116168033647825036421664132533705469309969, 134414925551558977983563962590292706701925350932479237089733599498765204384281062448202505854246530496996101727900364814621095385222627488129537943560060603347933201146532980651458908705144361055618936023653792901659964624509715386547300780368596689736592240350315453466740059293642729438516987203366216904052, 30524604980022074405649387911197033801794143317862010241410690142686179877178808173049988150563912620750994420753349475943049073875241734744152025669181308166028973179478006903143186726880955495503116871316888625958388432099227984455931337757212158409235996503540668872874921962599415464894697184485375587770, 80065262336227570017910461028932124638124626260308873123763231946607191642587958985499323909420382510928964117679242124532284287658995087774642116515041524267877659638541964235803894680474985523475414644737845128605940756458106579579341322082847168731230894527757655365913424648948998490925197875040896561016, 126551485440922083298209193113634623867323330012602111048573106334491957347002129167187193375478943994288653649840735983471097570475133481093290072464006210111104040238951748124361278781444232976778675772326892728748325109018578090889954814900087755275987731215267500274589184049599743895072697584763879085296, 77020499418086225450122174384146173803728293146856506816582894998453918690835011269320988441540084634390471167830251254020622096219197297375031319021686140199216208919055589689728803913516719370985303925549760021845374071411262346924472514857395611038748544866209043110334189059079310572333983759258576434442, 96522589179082943099873193622607423866933395291318942690394415799110329658023194901635279528076937389186229257912058573736188406881897924404488059357002972055743204488743006654048598526246858251018433747873670571332168175297991597838389203461501943686967162598346910571232588432676207921266921472983173342809, 85198273356994438435979724697544245419835411138652983981997954991863479288575776998919248610847559471380280758772017182038858520609489668528832322745329153383715952861120333437695824921637640142072587986749030944501250879883148451951677828730356046301356093374406944232518852759707101284633436319835154392567, 83309379206095324974841818748055198693541011905977590695993675078192945680492305966970715138551531062137224825075423248082336572976842114208787057359825983773388388079411112072661878952583975491079359245374838417793396969431690103159911232616555237909906906330530932116845989674060659768031725861062731728823, 14047091674696954474918573187507482083725761991291208740266448954830672350322541260810827832424308953720821726283638402125926446878412262519653573629691896706095542412686168591600185259683408518995845983782864839354564265662204984063758914678829710572812421694046017923092504197176534204805014056276944623693, 73823916191488067865631791619872177113840370003646775427947059205007923994588070942003862321731771111933516110494439847700448081552942813250709292790604308423909062344315194905176017868374844535372267544524117845626494048741873057235279265816200414085566551049062621429077584821140246540876443613466070831609, 127237762242818684630342413295573755820985217013625156122155791427961372737106580995952135238338498885875757014368381947950460634350071125795427398472670766118624613534379002260613916281978320364085993497376218876450709566600165046032112792168117845546373052567545212498111369610225308581737673195946668642908, 11563073744551274417979295946053681619405562223332884920283583105187521669916411818078609275812184656675186068205532204942815394985234930491901599243612803824795488173510692016371047565743839707321586004795222453047167177247909713801850241638734843273180262320583028745759977877528937977640122528403765889040, 114008065071046293377781714455608762468714995258722888450636018796774452669532472129808317053362560236278150757186089610192695815813672757664650724599109052114973850079894159854793180625583603534843641150855047707670097892348067602534176992143552326808723518704280544373468707160502853762954565581520093056501, 29779565334231883268537584581208483520423779584635669461975263592836328933714349331846061073073188319452039034968330166785529831642511225066350040032841854472255085725782714634306378842071912252480325402696406000319815553659466944317667065383860986895281952827158939949510905319258293238402443124083237207604, 110996214753053100741040209749921037456580387193255342339823357436471676986562009895538512550468126915511432171943309002793022225050464447787255747387599936669673320841003501954779822386437382732111546537361236571721202020065192176758040565695137013366669233060561056829464022894689362033015679073644863710192, 26250986092879237717296510858435454594909882220168107027354890040698575557240000190655939734924161208546578266114028572058742485465288750013518682538014520836669182941973310873250781608911231332861969852731637206729947454709691546362889720692159638060337255042736064765000507495537541221716032437582523366512, 82687481869396094167553883126780495705533744007243279663493186968650098632437147187406652352729304768748164695403258038336204350150712960758745009777385760344282519169972603880906442879873220562278710483545899667694853371131834733891820859176453127265081225057916835583037277974909165253250523419588552504041, 15685587470746639316780816064178577861984180585206404462296380925078638861236968112896200076874796901646162581816080071662823474619252408285972154324888385125352065479721705210288834679405852612757931906808622758675355086350472575903759110570448925372423950670761612485470132640255927524827282240004814764242, 43732241079597302033580098142984499936532983147809416327822115673020742785888121457206180320363471208827144314785178663876038872585917625983539161576078811655197900314213836887931254417129647589313309677165190085944996865126662838108539425459466149573636308457611878098841736582984182620317321399512803970893, 100559602264311866719132680750385147590142620835130920923639956474701107047244388248471949579657813558651068151898724049911785712419302091033935185999897480658963586432032630244536785946669093580358903949922597748697820008561509045253350373315019444030262951727104803948370512541312935670643119645510235258011, 25044766648479989661238978793650005949313251174723610433751747743673979505254358263095699021724869662868466830975631716282205593432884243019347595144737626184507397884332849970995120943612255073500313588107162415349847311180251157401283217625502845708268758412677604212354437487181831909940900335373241301670, 14934522784829409204175572460015567337057232178407614263398181534046312371598568204582300567819263826678694677075533243210491546892486042764076483040485167920964451606568613460968297679598829395138509337219338505424926039280944102653666875248134702452343299603122022310475958396912959516732759474699436772852, 59438967771477200833780511045115187820312282907247423173319762169776645915519938315186603731624779038962543197441122108392332245701011027622882557415638157290596527944645417889389351642307919717992271123975283731294512114936106263255152172075809228457485488673174757582545799713590919088479668371161145040302, 73294147359780648425388637191097068922087773627410397580437283435045535600491458011154662914061520752505235200711190643578975167608483253494909657337793892415395535789541842695798446076658557140548702082060135701841795367429467991419495262057632992556254950293350001062759269626179405714825006669668680885962, 45781824634728382751519655540827029095096726112193160820855022171509698261320204623468542365194378042203978006867782220174972521781352280869401283853141753593040226723805351916728718146118467175409695184864389950475967337115232750828793211126486179949919309118886454887297802287719724514777710509482648554823, 114208546134682496450477085921475343517703411436908645895753934034737779472925133962770222487894521950136430985923669818330937098836394867009093436547590108248415265660052266312717785076500659155201981397767592390411434358676180096898438483470490124429597844609348904328617456220552477836952257166870426442077, 46387382139982705823575603602711585230995878469503332692781479243833509923061952107937596505714836822244509806272504023778841776695603035697235855207913384871591060963515438392727774257940660480230743163427235047794491747788153000169249591021728924175321216174367976813058861436846943827513024856816909445488, 65746560854232119409929808785549313267929676783087175199541148597557708884645297922654351706981863522890120080548220841131968560093238932812901692551428289772198255258868928256858808300077298638581872020440822693613471383704742958257137689113878107909736693846154623329763027227981701487841590674132236439471, 45133814674186925974565087074764604892497458952481158430097959821250996498497297659804973833721165322206075852477950733501672804451735262392223172609516501188387452296844887843919969261595507207787005693897153973572631754128111163377492896336247553339588940277806901448931745234606638680584208385246507551082, 21263985033300314331823655604622824867799838926049124983677018983740637182488567205834799614265746290203519280677488708460983023141662581447889770040391143027096431663711124989370639975603377523215922482278358819037223953957407295573178075744857862305244591499637899976793864419605526066880268080246404277693, 106540006885247959457896473176574354998610233309752183276279678064742897178498662922589611086734234369353200189071203652507392072198158699029412715696976431947184804110312966694793500806851196233925941640946815205260116777752790839855087905324968229294300383161101410419914300323500080528545507878349904815141, 65328516726504813502633779243852044252762459209884171385825802543426689700505675676399274949376614240284159625238066324428288186631161075830562275582775482588365503458838618839418007762528467697029549775819587924696844840480376284371921009277796504715729128420737199572354473525570770602022306464395255704738, 58971804154251835282537262302846355109201020720126628584139417250024174024496207290142337589088222962505941991209199937978886883471157121881677496148774056453988156044514791184833259245361525556396384034117057302943999289240967950823972383467040627863723534465300648421935591006786155425516026397013088269557, 46290409080904339812390841901562034750421836774094121753436243647484685840658265861929287821518340925433685409406534809026555290414020347118668351092155840921818776888116723615321816911083350793854617042924200185705933720895064066828857166065420370327123103037881503675666179107399942959468701481274589731931, 117539065335145734931777059180213914709096966434520897721986213349065135772306566427657482790054684541454659867300702493385540070238272286569834189404487827632052675726880566619730689224244700820743320445673118809194125996255389893894907618512236327645588913354271928737933728404334030859378961791377150046194, 124978420561971621300324362748868842854621747679130548314314417599738955136906956002744789072366574056603369459469278599602541089656732111926828145035627573954994357673026061622846990194857755009959292765601601541651256758107117020897301790945908353351246229060394492103359383568925351611088698258640644556166, 4326492587868078701937783541185466213676148825875403919560297109492037866865039224351900971533307217925023533759806803168069162590265968638019276353037952755259524499315879074919156137342221999987797622904150355257946350671289681897812285964443501688019022306212061431635759402440478010113571974036012434906, 15859724794586512827159766755671472485254714882863333044352743202756274518929055690590796924944540162095447125556476122052776344566993884302277627467801267769014763902715345935142026603449022724888278121019515190287701895533771690043264598785893191762354525654463612265968291164768248819922262689245201545693, 111363951054360948588600924511666132951703256173365335037564252361841965839506665142027016566394138470147843670629147000031648356516592957778637920718491726404232240317880261752510866783241110864667518733816003671270939304775276473152097033716730430102483602345062947277063243825262706404241955439816359422719, 9251482568056962712079328539761779223381409064180578345512009239949914869827866473786389937820626917827702294333856725785029383471957457259662084413883608335229205639265332852436411886082309353737054269925614336654413679778552218218126592335582855178927710372980978485503715118557248289310460120127963869629, 102943271735649706726525275460909807778425623182433948903928601191254611410708134747705056255113970312658793774391352918240320714449309913314650864532349517510909351790379042212194503461146394096262637918334746428665720473996920093781170610868441420871015445520103018101003523153297895052347171626848558674609, 113643912614274217644624187450411715296546573652197287436722177427271450735827897144582595642866131161569735097602802280097570489485951670290551564529184827601687636629146775176345919232336050517990453750939667179590384358705549212100374666366145692201746726680512393180793015057094452684859507400644784289176, 129790717755041071454932567599200523607312668199444720313376783998128565847818827020335233686671765396336478757209604378247316112429464976084310503259448540223397304157327336456277560309876747698021668662780698964514905340513027651610462555593620449969546091674069683001602295849188309229066648031628115971015, 22313160991587138266057889455799482139788787817731007518634126856959592220153302863863610303459298324307955833075538532329967124197049788738091443484423685082615089206260856641952185450741397386728851154963121236325990626478393723244068655514905080427993803625797625182447431460945329335894902578889917738841, 103459580036620579570335255048840298181517122159020801979371734038108757091211520688016156726303611559799413785140768414354693820818701208795543726445733317676047903989820315786892462843872936394481469725770228070089780076750909947956722832004939753356302625947896755020313573002853629275809759870507171341686, 85796179999232988681609591249791794001968446517355759889331172071823164799281313054859300136437402147815839914385996598620105195486613157693115384484994490362402575551482579290226452676435233120513607278175678497966250342187768011968566504185887530008166277371762042774919352423325288055197957818850299343754, 61177994985171384685843873492757879417664492846561356965764961891351476869910753675686868737356439259601344366675910361385626321986578783432420553712895888743376071508020550400811220672044440559923746930460232768979302380694528700677424074849984911772530484762427810152914469323065963985476284721644726268721,65108284296339847759431773296368206857093802656195271917398734905536114893846708316986951099853884428495083947191766160184667052231065217843786321377135278221393747463223236781507440817827432508124727344346428579639850230527075968384131685671270088137613857716971491849092232224214638082163395844271259280515]
    P = [106867320942453336027449891900195957477381483000773940273533614638970789014738062368701649831588518504448830019528637424422418038666302926382136315871079440575362112935790758118605077823025358285680320717491591317441267325540334508750992055335433643579322793945778954451607173699005016831856717395926852710732, 86642371057451418348978997389764919976385251685266956021964989928024583662067695076030193504457159134236335187369861411707298159449276864943617696743125419015220921858295004959702737040229021638591683919101133153870159094182658007715513416679797064116663726381220709574446924802580115844846251286919276427167, 60087101363660314393154104969673421843421095187805275033107482854629606375451591571372060158186160098104499326583247162122054775622266895269130536250956757974453179071639970462172950231667472215967017109345468121983303186361097459667321896723335461019550874590875961768029139303900784583242466643384931562456, 19966053027965388965310303568738161901026135515752928398835806022288089527180357961822289446990029347226363789174830416124543022621369061387606430319011970712385329139548292733854046979887126343071067969291581628597053580340280963070867604515980929049426257729984047359956857360080855185729259099332048032190, 125688763487743274041847695855630447784622261673444251277410664199215719044800031926974554343725621631310501310910828113609062049792284483705760972272516957504466362210727892909713608057814297919301588590910219982028122519190791412317564803740827030607462574762957710097557485429577679909907380906813964746901, 99224287234114704051292681714680471812384363378104687250778401780280392508018060766258295979282847175218343278641400188352029078201310327099383532493009916791675571603519218535321664332615827383981910505051007967755214411711597556121600327593352045540097140004954198558759674478881153355937067984225101989845, 99470919299913494094653276283635689068338823186725872681068136071405052254795682706148547353695955515161033412513733296103763186796089340192236101940787983858988935549079862131261888114235810923641406782514903071367054277609695655632827018818400307043613757483369145831197052785355190028917878167112510531746, 11260139973804308836090484717235256372444971635114503218901357158752004811510098996163269559104900455538483152144230281001180306511724379387850012224213152796178876763225423167395560542889389055873123528827617116202004412270426059532550046853961858675586366271109868898084340976047966517578642529255289392107, 59278062938416230557550814955497635649355108767470820867980419575585336746655628286989517774368592000140652914685887177213191344992909015487650892399576372285965654582985066983446669451377508992877264765928502817169172759228966155394230363147187361077503494261472869280282834840270336951078401303194157664019, 90747108505492968981421275898689550471509777015388733734983794925676658938551286538068005266221933416966319014863525887916119648600566623777678129889571160402928919568021128066122618638239221588267499695230156429290653507199648955564915337019988160300938425693418887417570244475114603715281119796659898683386, 59437020448124914181699806864119224802245171306162203865016190909612234449441674584619897819398929661662994132747841460269253369277259380165199087777348958051424150202653190096694554912735711023037124233180932030371984261733286721908927073325688416669212849607307287475568658181848976816862203295306128402271, 81160231233312122999891712378994459230914956970398284996708937205645407707506639977624168231881774125775946307933668512547774840421230757717683749820031058236264913279742594677917661015371661801294641175423683642888136318653682577292347928250103183630497621484011921159177723732595965378330766235847799272037, 134468706853850002503283532555262117934639081512105427952901328840381545037860160428584309849736155837835558706045064177365044099250837510407003229157073171552768978126624989096646440351202162655590837979305678259259984397388430085327410883333097591533468968623353019253814842641191797646302351177291846008266, 7050237966295024306963469396110061088743897085435035323099238076511811111894654915017171961100826960723653189901089004466949932517654520149323980085182921507656026095800851833422095809733338726960832029740840382313452461669046219881281016806944139305380266969164067094906148898109196652398629521142938336574, 42824744559910715634357351829748910980979062265628887220102467803121565471442541771620489480565858677119238966431469174248868127848913649053480111794035834921340882540464454763745304213961019913706819055529588284782393266182483797697877577859407524183243922423298451641921693144589536029295185175734490678174, 121588307141407621722779122610976983374686672556840963882839521622953954288046661644149939853325738899438108363223759921936311837020641063535406455251041882020041245168278311603608875190628631168809634148877828887314815201429572322940561742939325256436020433290651177591330908957688189079952790068417596732654, 128397449719310300601847383946734995987247099747891619292411263228620608013146318029071092249862356770544834875949241908332448437277405116407282252824012320519848295576285871561585077847041950899577002248217839315542754876364602227778589484163221267078007646230325354171036210334942015393748696420405373400059, 13014468630178549137120891940399581833902137496736010431606952238219512550321992552937516661240399695703529917842352741563317546344980861115443754670898142283968299022863278309538239483868458767625994474379051388471296709307104605012334125690406394827322180792664421746865287556087746923323210304713951590965, 125643018366176073731723660900784961856530988738080061572108832073631842387192348773555838821375303454489480028367740771030522793189540721345263597758226798922849223179640731537307761404876954358091918953510653642657975873214418407577172598652773974428799051265599643546797014935357913688225573687790989474134, 50419401289060580097365312769415151201288131642592674837686995006873552806880394619564258795193449110562916635423819909948977198948370388373284784897580002647721335475315321604327462707657240408092577596156706474446328296577161777957691812454449778896719575407734683998742584454127396493065058076845834419061, 130256940232212039741710257407268884323171478635080924443718414580114250382153008095613887819779654167622107521763858827960922843422050989067433521447483354505514542183933875622067891735568159809957120019152746384633322689525687588346206787877727377513901629225773239353064953085075817923647745763656814338358, 109717791406116519419660635939100268311011415119982061309062691545412082925757887709444649912703228446287951558431098460061931750138938149992192484077603701490854049882426608459938079499752702143566696346168816869961663555831976263425838940912585097708470053037280075081132853292423662452514227378556014143718, 119024433101960778610869436754440357302393048715806514563029427104256293803960942817025326717741655675025279240374685187937726761483306347383755747564233580161005233645431525103522614580174448968376350712145477493206013291045932969581775638718321528790409629703300076491115057808072881430320873878492177880236, 920043102510139115396796846826511386099339894256962446131322937350471867379791989429269310909198657443203640899422796466806394871815622205206643677598079607398007690596893087332776452933217186313502155821443021476517889749735156863628472804358487121006899465818030940757892856675422682104371692797984405094, 112720430342807765494038563717588318483366040052513217911475473020942802705639845784121248635518179953943574554343396634053322528298302601231793755138750030523449272333075035523507556960862059323681802229707690490401817695031380604995739504471224444657384195575906144351582711809364681013205016999560817023339, 73075637396208418311076726020201075005207205771110718508934879671369890665158640030616920610209542333476651449868136913785394751393222073618989629619276592925188649248333233873214929175259520348470147184110842261052648885357368022104737077078939076863108673156323369849370476860574719234813551520640422983593, 67104867424119959314884016910192355492717988303264036609966831046550762783383077832493129415385302825636400165709696261294858676035007240419050451245803207493397246383101029899495212993862364822999062219570135638614184307512505313868827934266728368682440546494287204985685625224814005613400344243197832715133, 14732234560440935521900449522197085909401269364376278706636834631042266166933277266994703845590213221033510464948481082830952650845923467214907538413576548881066080966542843322440664149540868151679949500584761023385107197558326522631191307818709174210527079061264340636868590388320210603638524302316175065269, 58872653182132577926523417904922311641307260412053913000610619538958557457952572832753964687479039394487700941087341576628650644217103640997092427080872832589966651313613082677574897430555862299275451211118095138202607788192586243773433267783057965323148687849629927774226111611331224635807385701183714393911, 130552059485006687654895809601589140478245737338162222789855295748872775577101482678438256101735800396249706980497629886401301847022133160665728555558255610057423323754326663935743600962140219336588729155582849938814657396811676517400569448603390532762377847773732500780673094980896381521777602423706804443052, 84733329272611848257179998150557800214505368000886104409778668906354792301165262435240235094258272678904386056247079209125916973564749641705521579260425390933010958144305358918744792566895184455868351036700847096759536192174344214310838416313339015713090001607519357901374389514380369013733346541324590692692, 107009548188563499553017427993584192430487581572004725001996814028232459356103435404888370170785213289563297157147345414917950701906779748913172668701259840222573878620721262869269213116221867532575923135098682254352595484368527600178012519896483915953056074158950442966014375347656775105081964589109557875384, 89782769763762046235614607493068855975555821599454555124589735329005254156808024179855781569184943409789337019103771368786321566445479396591258396523266274107741949445015244117249030052253368588503657682652108390220966717629753358080861217369751237899651677972321950563944325690564433430516439064086870470048, 130554706995362974385190176298405619608667450902851472407138604085042025348092535632052210428583873242526085549129043621839039465206708963595883775837222643663315416655918859182118053793414896413806032055667382914507723899566928068366723615677181372233133965678229523237843175437665629442216631001069220843917, 89550793506958711493530823882669963744657947072307882596767531196314080276053876519484892943949260380220755220345845041359887000433548718669940459968405180113105954719332457693293285821337150899479698598452050652789724052866665907186774171584695009017211922945591325377324755956515927415087038817740231015543, 4042372692386708286302086666744693218452996164896286531062825565469210350790165618712434319981857055929902594309832827958193263653520044320013816685514134783681893196287990133189745753212632557627311484743477670181407045626649169651088762844856319168218421457096118839152705123005254095848827433061473972117, 75448469143987713824162971252645938998372153588950698611261938624734378019052257700999374262974000545067572648288329324969404932584183065616944130330931371959645089157445204342972940861650476948215337809550667551339686135051532848868920063768480819713790311290816193555301317456021064499207219832587541136452, 20179618105261330167022137375232732666732966565557338844459376065293747805621375403476852944115715338413084218165064999230123352018287473965970727415569232681747336324384072381713053411677237847210217689768240327202826353598922507524573030361138894343691323207450069147234712339855276760275356779190716291923, 30684607057302527570953501324307630607519526752668263598217184655293548798259961985655848189896083728654794810097213020958329649130394702123442236995819485489019470851209400397626724394985481103781281873999703170548988867838127271103983919327213437646688528309136031070951354973378409277528533175826524309092, 131141230217396809857659746185756716060549471116361075322321667997357635504991813469043066229726865213667690473071582873239674171519393037490573669777663837155534928308301972860708818575092857493810690291504141510128905224689876262383669820407610039046331585266744591460215611929807873532903967624567035186740, 92110473288673881136944782752588813572346606261417887911429015488634773131050495329900932781403658484790214056960873657116193199333189556135348488548286012322123618770328910731986208427668206857908987904127695331993749004348036584282170164574433010106483110971713576830531445652534806212934332091694214481088, 24972133221493919966312133602866516466792276262059975805151297183132312084920985420167145940033898868282022326501395420251235076916848702078447588837315714144213602761546589867862583710087220835275438790191343073145150429537873971865806051539184441766374437532136924398788643821183977537866145643995776526355, 88378361825060440317684802433433959346930436927430071010228252122815998525608522160769023231713351053726495133475922839870297915251178655447322328062950740416139812950073847022222261138036464132938746782188447999086558044592404674875768908112355104272237180765751201590945019608974118120181623272430599193407, 117442334243603474374451336516521571104965349104018910011470889992315304418240461059923039511967808834667809369079277406892389414075926306946320957565096631676060748731840493044225779984668407690512589643886575108042811507623875243651954946195269405318256533697372822449672907929499495852060335558948709406964, 69355127311746322653727536211832450326318209718646196381890622553004560786004302136633185493022190707913969683722937234431901834240863022336771857011442242266982511079813589095388719738210097003346337043752994912897830627698253948985883349876775413062372408502056453515445213528528560461529537213663244511856, 131371845606466799661262978587677664292604560396856652900552921223636072390069201908853595468329838959834883527825569151098208436325746347721926350778539243871452299994369942690110197580797998629488276632327751290905335160541761866268356753822184934313001204573509778688568016627922591391277649159688814501044, 61343964155973920964994946902606992942245105225113733679079997290998683834957636265469859373568090350618353027316910526782079209943265737523513055458112619548829278844555416886322388992471725739898374223925611261537239767863959621228644361106144668226425641331589819778416927240558668230340029935959935350313, 28406310803242925783495563507450214344829539613274808835002385972291708622441249190036188855647358431473251033406950208610217858739842046552054523514582797336317731804334559938703646283801783181636306371872548122821054644971688837140312943030459955668921845845175343456955985089872271218759179622131806450695, 123226899281754654159540603136831368237982004037145135752508416174875436976364040413153739998640065060324381405136510388083151450429622975341932012825640704223647608773578453210230615590232112124316983904944154490979273682552987948957918499941098121228028903383648521543196716307471991136869202270702949903904, 92327525728141690513174385213065866832201751565077355130881986654462686525595976430493952561006613285145199993127681879110717431090145905092939324901930891366570493976157525797143088780533190942200972776481292342306271693706174905874149748103583021053091073022900219367172779489670602660746833113837021617673, 92015639341760926741753004738597215170396713339659602861093487457844354593463815132811946529584416148445540966878523086666617875070684907933412718719830564895160751452060317222320505095307534337797662193076707930679314152650989025433026678767790713027561929941915062122585427192753385176879943057845635374679, 112331933565817273726655894854012036769841420272002464336307773852860341941250858142325603955932109324215987269825894372269168700840097941224844057870033048104957723032481850847780588249250272907161857174099555764117338001709858259922590382686343842540371764129026374676843629553058268490241367192748360210683, 126144261808986989768327271073912078347096896714876299175567270340786089970521147552835254798491910790664018766556606422784855631684768624757454499626716617259294694777916270964323412733401693018744850237241745395115540926530489895086936767043143127855606286959155484922721055646864741522554373778219922450965, 7049261495358229627218251558590294912117923029985929300677919418611957914252211143208215316672106801734804606802958773414813114597321422584989459896578633237517467552004571351969780399963742634528852746897767853362961668636812270471447970455366862749426987074743621240266278256268437819342907213233370685490, 108845314734382918146255806470073027226276689803554781185949766364370132041995132914589964515314333279692641926069832489849603815781007287230207764786013384908366552116527996844336644030156435142302765151061003842866101110785586328202140835041278078251800242284706375112269253457855486087967944282371191563394, 21146040547497819520808292621265239694557381663893295030325698387170845743963198771454611612768697752796752181802529372847981790048104898436327949950152229084176735246399661708458991385086129352864801388734363370254290375107574131186997945220394070617696029659290213494759363994315848007810188424088486246812, 113856086986148339734036317636471214831923743398642713514953681062271354827658879718387816244288211389366615166458267605042697710112439300792507811326340341389977030054257997422733265825615641347138382977189979238205670069765669182322532028296904627153871014161554808469620305504150839827310105961317298372219, 123439817261860740008469497529641888516512620543681110413164743802270366795512163231253756033700505981362089544237645559416446654099257727393667118436697956702108553788024661731653242688433160544684262639592931797324836499601547672280803867175817913600115689895961724500445071631545206774200833783132388068109, 18962740274910334431696945721023451237896147730081679298769130562959097388026922732398033768056850067837765318845069179794643202397881497688386320903693924842671821161243518326559494276318352598266747862503121188190220709607723339938673818641015222987760125994048668899224812094334464187203769955304588721407, 96484926804071247230803683136106682144430082551053153523376641513036107284247792064705255295763724928114734747886925987538021904391306769549256964841456982342037030866991983492978440978689243683181108073415419585499041608643130333047092600078437934733052633329370030002433977885334272860853794129800632973886, 106095031141400165775947818294555608224717851533874392485116950737512965337023687827337725155873692527112509278928893206720281802983698130130727438078258293234505458302579467639330001633823558509317097041927824287834437431214938973744874991656368656379592881684045389238229802741199477652359142663161621440424, 81583531847664165031018289012612866342511255642966709020593306107914919496569552624150041385620571828047691862716256728680375467055253469368885016476581954053376587577983456053932540254099250195354597033416803090688230848669487774778472551631275261006464096759704386893414751796431862174124161129893982650337, 121431476125112083487732310992718987380535361105034600600419593302240362772391840619443625618625481454711615859919650259767391101902558118552917368985490620461743962622333385702532917896815633004329174599072202973970290133654427738252511950516874690096656250120508192655462277268592828064943963950883854404598, 120035269793747047159752750844893703776915161346920079997364734326674990282147705829087283170037873254199649855622672856989374239912779234519522058258123966895538215583234567707497543310496248452021170659001203699441879193714297621613319007381118635168232949560297555878236916472623966057670515221838685892680, 107094026072950425133872360514290248524073353885660502282247753675825400464542569454608916141822574887943843240777569997555434298845692370641715528299176116907269791240349348957684630922283156532062693427442829090712798385280754786088882206623731643191054699532577461967521550584182818609671923370693854321471, 8732982190596984405489400275395906395416656920149396848105787787884310812575519550574300243129746232336686110715986554010310070108424048513157117590298873207864858127519427635880081433650458279466801799418326644688054592796472134450394348357528690339130019640902407018184553923972293506125939920350405504585, 86006080287968230261071625040856806421566959322103118186449687169484036449063016710190632833043595825719896087886210929250974940849447418004315959462458567809067521691673805035649884570017617639302357467406831115809019258315913751822733439148022104174451026406997488264881231301277588471333765484781353175718, 28899057282186083438317904160444970104368200953191161491034267108491140983655762334267723486386404195368633571588059305704240194815570528912871332340078596065525824815158291652337823942767165531650163229534955163072241220089017484537428311611091330798395156750025392484024127853049379618163739137656274757028, 15714921782869175972152949373836341525239365811842351273721539267710936571448762733884308074475096150079811225693248894189497921953406965245945101807942422740103281405772320697809867893732316770531626939395531679426261311605052356759562019843015863898987124722907361028247794797577762008527564362159051492505, 13017169935876940343576305633802382837310131809218545871021360047860337703551509996086821337633886538550623055494592143540876710491718600216552786953242372084349419043645290587746063208899912556691728417865571714069314717643319592026600408294666126155659890738507557971371918085905168293630116534137761035913, 118229599297363217518732536002390496881482123541731564424820342329347281656701220732225479073142488222421298129663953928182146270234612021542957895922879950958162569338282055652718234291086168633979195293111109822315452535498801843563656489186114959622548284135580186441620747170089877683412356108915082795061, 28351416104248185111146806211575104150849910335983727024022005427635564774095512430427651670648558429360510673954913023850575359123799492927539236039992977922446823046609382229564256228439387402467541924486994113129317473839598454447572212540394544513564883314541540142388345209413249726072049442868535710645, 17374111414402778571004099236271436931778124304223434702978736071512525909939598970805680021734991439164095256308278107903055533950157888836009168546064168598965656320275057987769172269107098304301716856321913036138356585338771623765574928386470605604445836525024274881362930185999718342415791694240330980523, 45297256664835497375737977577745017103342587815778273704701929857226468104326322036718477993348432517416459886514044122842576507836775303145718231892657644042804735273895914918723136005499188340388324151707544255655405498197041646654977356929422422666331122939702409968588639334783196215582377685385496059805, 77434698668050853454701587573877485203160413759978893058987876687530883013606433767736666667243393597610671279909592244023779906731412071660357808984373321095780034423384992590922007439497562927540289385375274905208785828770916020366644847330442031369222866367396829998425700962144595058088048654806303867218, 65618415622685493153486785764312550834404528936068016868031592284360736155106182119398084455540399784832220977947920106293159504060558875475828058966499438630217250322274120236213814322782920114611117041763602423172783009244320408942098298855981009769539195418137743822890166239607204180241890139608664834738, 63286973407237524925395877836789548607226911231523941425195005423141262798517438464446373107097237819376379742273665020476913301907059519674475472582839984031994160398016196624789236355048114587742355446954576545395242843150587258422134080395361289000359782019010690209667942708599358548923459167339281344679, 10507392120587260995776556733739349831690180762857848841421349074354753819840868708198235480603701474352757778925930896669980089784535665942745276602068184503115500389198769759541671533535728479459480641421405631742472892214693144182581843778986295586945187307423945376655821992753273578033075723642818040706, 48158262830850905250115980780655914931671394713410743640366165474772802101189047250649705545345157801918092403445001330979418817514727627874064294000072891991488348259423670965257231608177386934870299587653935279631802095737577085481342925307059633064100763104065321679529547820052924490701384674976886597625, 137403091156409169843117114652980511296568873197274191421502094799270612208955174404084111261036111421882517817182853801355835588135658604477926339087986038196419043143854063957516903469697408408911941856071920515673391090927164921826766943287876775156134800565219015280808077355298785024875265867736707218311, 95555750501682402856332212916529267683256173817748708042049224330942876209906046853747193993345712075408915615461742335860044521593242319153154972630519823003145992611159994762667224051254609334969516638877517930346767803050021133709064822795435980261216755468670295643310043455493263258110851327173293983937, 57352224088423897289481693371330499559987387008773121213617929780986104587561506395318242318732037760666072889365683685033657932216346539641827422688070906746170879257989900867064736766517282000021865356313802982657634944117820098124900030525712599265971242382157185517353596932214654322864222535203396199462, 131384041824719760156686972605665325287070265405926696462970580387449720478029566300981962909673234105317518406920659726529651468015100703922719225948746460044081697581499323503095293058804717467323903182806246408696944326034469026141611370707558784245582859762720137746942624171525348709533149063182584619029, 45893083700615901099624492265721266906515739631502161668520646800030727420547952144745520272441625843453833682185457840003340459436822152714385254172145129927426363706546007046733155799533342137905467344433152567271182236623402504500413447763314035400578513589795457948420608495747759150592108417049156636301, 94456570004860764679904423340254787514557587185575242100694491529837977761244252399196481036793149753256560141139220802453663800730014626396084832446386826888739513864069276977342882568900862401128159332899107663615075035929048209987143013992782667762387585453224380020291441708574872941059369657821667779583, 126303861347213701830205743856646412584725366320050660381387312263032148565014682162510761388645995080809958162305663735878755520317544974131304916247146382280936659743847588701931156225350765373879271693806913012246872451437924799875687254813757242494867811597963369679929678942240554911456692365377877743669, 85236485032726536909823270666489518949985058348797281699439636454258691939074330040125188940384024081876572411738040728768449983982247250985766699378485084790576337063013546795528759657189334111339273807676718088481459138483729310757904611857227124186896107363571143369348151669521394190723120212639534721019, 105251717232287283889031853368447441711582432934258617338231876386172021454326164130636127633215530069513522710009968846894042247451907291230194999620288333730466575983864106250429440298307129250990734515445062644049802773355976173213525485076303984968851001126938259419589597796379195000610390075033460675562, 12278775313802456889549707614055927909306982706344520575468288462536368573372354635935913890275675929208044438575387987164662594710182021917581686514143220737845831303479009836053209270303662644672094244066508148779632717856428508924798449535990893851204571447158077698994795952185947331339260480746352512294, 86720781008453849750894461912869299215811879399138637739037777430360913364021249646522941326001514293473400124950486348915019636835995282920000144281070149671231855340313651223018833343555335203380686708493474873588904289275039678211811269861016518806744660760143198235026127632576501648610481846016456674509, 126734544301583387604334987597152238349538293264699505937296596643420651488591609665480819811298218027155647867142917740726435029737457355797623200141868738484999015942045320734239897155472864576601573752728283532960119985227731824829709824881878094957788347896731412372635852814636445997947862689833130920829, 8295417063761155974946054056587027780850424967609885771908682877013261307921887049178210061927575426737480687856380083128610545825288350474401052486272947725638380599052254375067995429861555527790299023288161623933787665442267308787048107058765528284242732227859854254164926794800416192224601121097458902074, 76819456857689136025084444401301986125521964948436612805963297379641744345446669691986238704298327391291817987017760519986861705420480617602002616440382469537260604794992083136767358877576218022180111706893505740037970016846431921102363424608402159343033293375498767246766786488914873147961692718777529166452, 25207521450310967351177711389989498943154827565775395729188935382101613285434368221275466302500360083722233329108377909316139714079093424317421015958805829973697570274442487078504193708466723030909441107387301054227311441373150840652717697225563684264784706894795255994529060517506233538368750163375716643342, 121140045866052654180464091079011976572818394862647652171339440579382659451237314447306775079444860247108863998365404564548415423718103680086023506857144207062935747674274162037145835849250657568432960026102779698490420611750881692633905899053689435128703594135723698773626644147405651976834518126829874618446, 52583376999161481037327383931604913181856867769219370684277998489235935133178668020902124285796252076355675821765090839759595064566866154296612008905217218611159548498223501027016390067915136474211947636721629155612463025017848716423339115690787027362508005110762934597583415635224790773059027553750442254371, 96690876073578300585634623608115603865219243390787424632949025084764615576220556610023768188815439181247931509371369792569003935109209956576330908188960583847963183155904779835076346323560001311545785124253338704455281076090618151899841355480901608775003697750761971321417240042770942477427074690092107010252, 95935407440810019770371304319079000354648151749741526570889203144380221365210933181553748010530618889248463140358862374614228864801526109361823438963281265864931860423598418454337109969699492655632831486150130907185693988902930850701289706083507005587652122735255978948670504444853590084806366373327201339962, 24676514498086665877923416225788443338016060425794087107123197090857566847792343742224038849382330640473986240994596839943578522285373980592932445584179493679255896947149532623272021456741390263416599767587632706336323677268478116303359465593611157564010558785332323778438402252316453506706656906003930190114, 13413825408307661588492998566276270804001656279326296204665215807714631030728802130308295432065636614390074466457045621013394953198452938434992971750244941128832848473426814934471920397247267770062946129131296818674583492161941254725908166548354684929943605674579030912669229714172638032641471855550563396980, 73784112822640634630630580482540989935749882253133454300761153272810753696792001998050788929684449455403203771645582363908474286146006907760990239556675255615809571917131296120477677571649702421527045717237803458680719365200137326941095755057623276130507920111306903771582657594730028330346929177106710997862, 20659596198505973428916745152490278774574793569327392447570740342444920146152741077986899265926256251855082350451105209932244212931659671967133546330220361380721477391918164884849593231168366372283956855242658724496796615444152495594034855684820619857020185605400722971156965920928167327931317012024707964093, 38309943272077032939622085391343383948964167052861401902055540826112706651532075608968379393808343212148653845951305974102974330114453016678664719545618321372399911047611582759383920939424448042802418634052442332438637642459110872658890708144094228561368187878572644653876405422819430804997803263608083953302, 475586810823593868614118829328458568308444551823733007217694827118325875250886009422199548117568956079397457743913721478276339898684185304908572838530754556175279994641684276334949029750184566293157908525220634374389881680198438874935883627787138803575848377848445301487742683564953558561505551503138356122, 83412653982911341425696963453045891722043019940252938821339601618127667792648093938822902439228165880209673106505062202838998661234763156986989642767764028643400772394396203455702835172791691045805003130038880104514443210896351428850427651159281200765458492876019512131360298983774013745934409070244647448036, 52533094417164366934098155810807905409507843215425248588077152448205289073267718196802019818432129598177242248033304318175300625975126616139611379299750725819272824785412530811625964722576227758189826162179844003234598828774499238911167396437745250623540063243110090772150385428509023155134599708856091693324, 63893816526099457075030129721908066321240711438820824336187258289430970469961638547207324016196070585713660363058011406154362749082850796607662607159271577822157627317569138456250251781781000217921355721693705617932271441448892822964776491510381603351152905068078568959265778117153993254065144426085284219213, 77044146405745114337151291600612641608833834434322106447204842309940361409104252837342363829748209610001817060669861853506278012406991383010615047566698422291598175172296771881158926457610037945252480798141570164266529067891042641322472618911118768796148316451581602545950779380512011059295894299449076130903, 2725598473015762183075006395206304280346957800528077279467805557921974642157485587118495576716008167646994288695377165797243313394799568789915340641387964579156304059010669022325826975911535761562771630022683678120360213004231533971183509857340532965929467787103739267767431117830549059779815918451699554728, 80953887076551544996038066911072833613096321519003221996730792755744522533757773015876184921736557440239368533961481975424284375137753504530690239986254039993183849833143195225562396474342882034588402029660821187381701047596123237795606938272212901208962604767447495869493981031175208104843607685836354380796, 20727992235296496778587504550052337202642839217500497900374281248717003479467056204940770848080202717344211613739595248686888722021448307603117316035590770161852423001340600047475535829730481022721907766884004441077257694480374121511959700691072957867486751646463702787433794578726890031367375843379188200201, 94910590253328425545454799379980147867023544996923957409514883616396647990918891516055238881514225289044910872850686030467026905344607762634508526886687381390428354702350732012517329752382858107494791669079126370703189040344564191390177750047654203207363103551140972418378156771757068136724094269118844617297, 134335193981678735054578425233958240800411682631695453447385644542917333557207484626525711361028435642330238321115897348109483212975351074875482846679682570658431882882481143374583443650263779262279783789765460438360737608649119573086202603907416922651273799753251752228960166752978859482381202316772240775116, 126163498566123368906283295604367588818946454923619549563797539657068137535632160369632391862126818460448788249438546405105914543919055775663100058977588167521609727575354949770886702487776581216021862136400781431310140382903996498115507677627169433838451244816449048632556958067348864559567562261780719292255, 35709045045752832544994696203447975134337950281231300025107253721152176152316814534134684191706399022089897447108835709313908497325082537614463420115998691824996204799390378639026284455273919403130493668779456762955590584949443350867044647957989969497217987197290450997002185182429315317215657685859525689420, 103500850294040550442316648734578001487002793049754713007081402217491104976873028026166012367329511123850814478123604719175331040664493585926815397231677080802506750703045398893609686831735212722042767463955375935905761972138773740492970534358170028746907349399564401910053553348385863046464723101018278040637, 6042702066552130605091629033933611656003734733434691096541348920205950443308225594065940049271746255585728727206649209504294253050530724073803467417872989487290211304861091332938816867688477495828330071922582240101747900425692089540368505920166309809219584859338372674805229094582122613406175614920835713223, 23263995104730655733571331443034878254880577435993471418302066143273891226433724397540463722924779905951283515162024857239423192876160304498463999129187665992037094243587491410784229099228357345121658884536315099120477600054070344084598431934504432565301625507878236914804676355200588457131384341783327570607, 80264755077143482279146152007812940837232514497010533445898986993872555517195753998876085207474543420830253723021866768392524378414227935454975520142027505237262976939774162423731774594104059312908243144953641940402711205082128226487888055289923519935815356875832286429819739099668710053923239815952326227475, 102777225345493291578973535667749000790971546907323272580608584501436749769676725669265359595564336251103733194497756167524653560112669973784295214549684784592897151215308180094667395342106792268003065773805760294159829310543326821811403576838677899611585951003459569911888146269210127857152147109691716052762, 18009244372776347565359866749227292836039785744349520437065534303958832102381537317540802355426766991909040732209518039876587839708466362783920261903747084711698806058421607405268572408344761999102560291098223202814722540503418192991514024706269779601406464459481294808299679619197829190469843777878979436065, 69126274607154530765080559207972450969369437778054558395445714320954842540772986397648888460125855373565205316795124555327572982193384697831348618800196400689672580753911197560395504957656396107044427407268205909781975474961407359330587158945038275993917829438314713440149541604382372466783440965149766360571, 88533011200466937975183262895680941430222729708364078154275619678638413190787433189422982396809705025793779492444357037092514707088148270559151762208041106126756374236142040077831461139440995210826139636992121424168724791772086448998449277514046462430130553558852510987717974466113772653941094092088251992153, 79229318578031279208835068283166444985120729589396269211576488717505043456511534253646600481941648329032547236382294253151035066240378602369119444148098519595103782601468393667649715249805257761838631070122858398346152500197782755172383932508885844635637920306071745005149863936278041473792795344334963778512, 46308333123786421448468137097417568139223380086619160705366091889566647561623186041791320713850647286563446694139990924317132032143249941632315493374902183406815960407247646945929615493611773811940257809273332239157299768659030154055587382912994788835875292912767399986363849069306829789985322708933368350591, 66440937557776236393937511230457767735963805709819565824240726015309133427595985957187176437158770998289506015748711573225976332130467595462921658626080042213786639224357518084584114768897341518633434071200059564378247984992221418242453346125662963891945594140682291682760295585811512558939120073060171507637, 94912589140901199729846160283908484624265381479030017099092909309645223005510499643057743731465921726605157097020402463711534982209987533986854531700098196081999127078616052018570445479303527197490749744192740523109325786551273967271647378452815718246715817870769176288516869024659881021106641647754281031529, 8689128828645910706161644555457539539629583298047306554046893245718271525027165567523076622811054463101218639271501006311351545668599944226588308964720122842495489921212458392913198344439238868574830408797802923782807627611180406355103187222001822140833589798845763165348734648449270147737513080290504208886]

    n = 137725961471813929916873436751503833633419023172981422071813669703515379956794912009419251797716310916384163249162387691776595561410347688672036448650400045633852321048634742560084644374299357430370170162291299871751649062671711095953003811065705234292205069393065692100748719483918140430872651034622798359971
    Corr = [4, 5]


    K = crack(P,C,Corr,n)	# Retrouve A(K)
    # print(encrypt(K,[1 for i in range(128)],Corr,n)) # Affiche A(S(ffff..ff))
    # print(decrypt(K,[1 for i in range(128)],Corr,n))